Traceback (most recent call last):
  File "C:\Users\davide_momi\Anaconda3\envs\OHBM_Course\Lib\site-packages\jupyter_cache\executors\utils.py", line 58, in single_nb_execution
    executenb(
  File "C:\Users\davide_momi\Anaconda3\envs\OHBM_Course\Lib\site-packages\nbclient\client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\davide_momi\Anaconda3\envs\OHBM_Course\Lib\site-packages\jupyter_core\utils\__init__.py", line 166, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\davide_momi\Anaconda3\envs\OHBM_Course\Lib\asyncio\base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Users\davide_momi\Anaconda3\envs\OHBM_Course\Lib\site-packages\nbclient\client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "C:\Users\davide_momi\Anaconda3\envs\OHBM_Course\Lib\site-packages\nbclient\client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "C:\Users\davide_momi\Anaconda3\envs\OHBM_Course\Lib\site-packages\nbclient\client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
source_eeg = np.array(df_norm)[250:2250,:].T
cutted_EEG = leadfield @ source_eeg


leadfield = np.load('leadfield', allow_pickle=True)

epoched = mne.read_epochs('all_avg.mat_avg_high_epoched', verbose=False)

for trial in range(epoched._data.shape[0]):
  epoched._data[trial,:,:] = cutted_EEG

evoked = epoched.average()


ts_args = dict(xlim=[-0.1,0.2])
ch, peak_locs1 = evoked.get_peak(ch_type='eeg', tmin=-0.005, tmax=0.004)
ch, peak_locs2 = evoked.get_peak(ch_type='eeg', tmin=0.008, tmax=0.1)
ch, peak_locs3 = evoked.get_peak(ch_type='eeg', tmin=0.030, tmax=0.1)
times = [peak_locs1, peak_locs2, peak_locs3]

evoked.plot_joint(ts_args=ts_args, times=times, title='Propagation pattern');
------------------

----- stdout -----
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
----- stdout -----
Projections have already been applied. Setting proj attribute to True.
----- stdout -----
NOTE: pick_channels() is a legacy function. New code should use inst.pick(...).
------------------

[1;31m---------------------------------------------------------------------------[0m
[1;31mValueError[0m                                Traceback (most recent call last)
Cell [1;32mIn[39], line 21[0m
[0;32m     18[0m ch, peak_locs3 [38;5;241m=[39m evoked[38;5;241m.[39mget_peak(ch_type[38;5;241m=[39m[38;5;124m'[39m[38;5;124meeg[39m[38;5;124m'[39m, tmin[38;5;241m=[39m[38;5;241m0.030[39m, tmax[38;5;241m=[39m[38;5;241m0.1[39m)
[0;32m     19[0m times [38;5;241m=[39m [peak_locs1, peak_locs2, peak_locs3]
[1;32m---> 21[0m [43mevoked[49m[38;5;241;43m.[39;49m[43mplot_joint[49m[43m([49m[43mts_args[49m[38;5;241;43m=[39;49m[43mts_args[49m[43m,[49m[43m [49m[43mtimes[49m[38;5;241;43m=[39;49m[43mtimes[49m[43m,[49m[43m [49m[43mtitle[49m[38;5;241;43m=[39;49m[38;5;124;43m'[39;49m[38;5;124;43mPropagation pattern[39;49m[38;5;124;43m'[39;49m[43m)[49m;

File [1;32m~\Anaconda3\envs\OHBM_Course\Lib\site-packages\mne\evoked.py:711[0m, in [0;36mEvoked.plot_joint[1;34m(self, times, title, picks, exclude, show, ts_args, topomap_args)[0m
[0;32m    700[0m [38;5;129m@copy_function_doc_to_method_doc[39m(plot_evoked_joint)
[0;32m    701[0m [38;5;28;01mdef[39;00m [38;5;21mplot_joint[39m(
[0;32m    702[0m     [38;5;28mself[39m,
[1;32m   (...)[0m
[0;32m    709[0m     topomap_args[38;5;241m=[39m[38;5;28;01mNone[39;00m,
[0;32m    710[0m ):
[1;32m--> 711[0m     [38;5;28;01mreturn[39;00m [43mplot_evoked_joint[49m[43m([49m
[0;32m    712[0m [43m        [49m[38;5;28;43mself[39;49m[43m,[49m
[0;32m    713[0m [43m        [49m[43mtimes[49m[38;5;241;43m=[39;49m[43mtimes[49m[43m,[49m
[0;32m    714[0m [43m        [49m[43mtitle[49m[38;5;241;43m=[39;49m[43mtitle[49m[43m,[49m
[0;32m    715[0m [43m        [49m[43mpicks[49m[38;5;241;43m=[39;49m[43mpicks[49m[43m,[49m
[0;32m    716[0m [43m        [49m[43mexclude[49m[38;5;241;43m=[39;49m[43mexclude[49m[43m,[49m
[0;32m    717[0m [43m        [49m[43mshow[49m[38;5;241;43m=[39;49m[43mshow[49m[43m,[49m
[0;32m    718[0m [43m        [49m[43mts_args[49m[38;5;241;43m=[39;49m[43mts_args[49m[43m,[49m
[0;32m    719[0m [43m        [49m[43mtopomap_args[49m[38;5;241;43m=[39;49m[43mtopomap_args[49m[43m,[49m
[0;32m    720[0m [43m    [49m[43m)[49m

File [1;32m~\Anaconda3\envs\OHBM_Course\Lib\site-packages\mne\viz\evoked.py:1992[0m, in [0;36mplot_evoked_joint[1;34m(***failed resolving arguments***)[0m
[0;32m   1974[0m ts_args_def [38;5;241m=[39m [38;5;28mdict[39m(
[0;32m   1975[0m     picks[38;5;241m=[39m[38;5;28;01mNone[39;00m,
[0;32m   1976[0m     unit[38;5;241m=[39m[38;5;28;01mTrue[39;00m,
[1;32m   (...)[0m
[0;32m   1989[0m     draw[38;5;241m=[39m[38;5;28;01mFalse[39;00m,
[0;32m   1990[0m )
[0;32m   1991[0m ts_args_def[38;5;241m.[39mupdate(ts_args)
[1;32m-> 1992[0m [43m_plot_evoked[49m[43m([49m
[0;32m   1993[0m [43m    [49m[43mevoked[49m[43m,[49m[43m [49m[43maxes[49m[38;5;241;43m=[39;49m[43mts_ax[49m[43m,[49m[43m [49m[43mshow[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m[43m [49m[43mplot_type[49m[38;5;241;43m=[39;49m[38;5;124;43m"[39;49m[38;5;124;43mbutterfly[39;49m[38;5;124;43m"[39;49m[43m,[49m[43m [49m[43mexclude[49m[38;5;241;43m=[39;49m[43m[[49m[43m][49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mts_args_def[49m
[0;32m   1994[0m [43m[49m[43m)[49m
[0;32m   1996[0m [38;5;66;03m# handle title[39;00m
[0;32m   1997[0m [38;5;66;03m# we use a new axis for the title to handle scaling of plots[39;00m
[0;32m   1998[0m old_title [38;5;241m=[39m ts_ax[38;5;241m.[39mget_title()

File [1;32m~\Anaconda3\envs\OHBM_Course\Lib\site-packages\mne\viz\evoked.py:500[0m, in [0;36m_plot_evoked[1;34m(evoked, picks, exclude, unit, show, ylim, proj, xlim, hline, units, scalings, titles, axes, plot_type, cmap, gfp, window_title, spatial_colors, selectable, zorder, noise_cov, colorbar, mask, mask_style, mask_cmap, mask_alpha, time_unit, show_names, group_by, sphere, highlight, draw)[0m
[0;32m    497[0m     evoked [38;5;241m=[39m evoked[38;5;241m.[39m_reconstruct_proj()
[0;32m    499[0m [38;5;28;01mif[39;00m plot_type [38;5;241m==[39m [38;5;124m"[39m[38;5;124mbutterfly[39m[38;5;124m"[39m:
[1;32m--> 500[0m     [43m_plot_lines[49m[43m([49m
[0;32m    501[0m [43m        [49m[43mevoked[49m[38;5;241;43m.[39;49m[43mdata[49m[43m,[49m
[0;32m    502[0m [43m        [49m[43minfo[49m[43m,[49m
[0;32m    503[0m [43m        [49m[43mpicks[49m[43m,[49m
[0;32m    504[0m [43m        [49m[43mfig[49m[43m,[49m
[0;32m    505[0m [43m        [49m[43maxes[49m[43m,[49m
[0;32m    506[0m [43m        [49m[43mspatial_colors[49m[43m,[49m
[0;32m    507[0m [43m        [49m[43munit[49m[43m,[49m
[0;32m    508[0m [43m        [49m[43munits[49m[43m,[49m
[0;32m    509[0m [43m        [49m[43mscalings[49m[43m,[49m
[0;32m    510[0m [43m        [49m[43mhline[49m[43m,[49m
[0;32m    511[0m [43m        [49m[43mgfp[49m[43m,[49m
[0;32m    512[0m [43m        [49m[43mtypes[49m[43m,[49m
[0;32m    513[0m [43m        [49m[43mzorder[49m[43m,[49m
[0;32m    514[0m [43m        [49m[43mxlim[49m[43m,[49m
[0;32m    515[0m [43m        [49m[43mylim[49m[43m,[49m
[0;32m    516[0m [43m        [49m[43mtimes[49m[43m,[49m
[0;32m    517[0m [43m        [49m[43mbad_ch_idx[49m[43m,[49m
[0;32m    518[0m [43m        [49m[43mtitles[49m[43m,[49m
[0;32m    519[0m [43m        [49m[43mch_types_used[49m[43m,[49m
[0;32m    520[0m [43m        [49m[43mselectable[49m[43m,[49m
[0;32m    521[0m [43m        [49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[0;32m    522[0m [43m        [49m[43mline_alpha[49m[38;5;241;43m=[39;49m[38;5;241;43m1.0[39;49m[43m,[49m
[0;32m    523[0m [43m        [49m[43mnave[49m[38;5;241;43m=[39;49m[43mevoked[49m[38;5;241;43m.[39;49m[43mnave[49m[43m,[49m
[0;32m    524[0m [43m        [49m[43mtime_unit[49m[38;5;241;43m=[39;49m[43mtime_unit[49m[43m,[49m
[0;32m    525[0m [43m        [49m[43msphere[49m[38;5;241;43m=[39;49m[43msphere[49m[43m,[49m
[0;32m    526[0m [43m        [49m[43mhighlight[49m[38;5;241;43m=[39;49m[43mhighlight[49m[43m,[49m
[0;32m    527[0m [43m    [49m[43m)[49m
[0;32m    528[0m     plt[38;5;241m.[39msetp(axes, xlabel[38;5;241m=[39m[38;5;124mf[39m[38;5;124m"[39m[38;5;124mTime ([39m[38;5;132;01m{[39;00mtime_unit[38;5;132;01m}[39;00m[38;5;124m)[39m[38;5;124m"[39m)
[0;32m    530[0m [38;5;28;01melif[39;00m plot_type [38;5;241m==[39m [38;5;124m"[39m[38;5;124mimage[39m[38;5;124m"[39m:

File [1;32m~\Anaconda3\envs\OHBM_Course\Lib\site-packages\mne\viz\evoked.py:664[0m, in [0;36m_plot_lines[1;34m(data, info, picks, fig, axes, spatial_colors, unit, units, scalings, hline, gfp, types, zorder, xlim, ylim, times, bad_ch_idx, titles, ch_types_used, selectable, psd, line_alpha, nave, time_unit, sphere, highlight)[0m
[0;32m    661[0m [38;5;28;01mif[39;00m [38;5;28mlen[39m(idx) [38;5;241m>[39m [38;5;241m0[39m:
[0;32m    662[0m     [38;5;66;03m# Set amplitude scaling[39;00m
[0;32m    663[0m     D [38;5;241m=[39m this_scaling [38;5;241m*[39m data[idx, :]
[1;32m--> 664[0m     [43m_check_if_nan[49m[43m([49m[43mD[49m[43m)[49m
[0;32m    665[0m     gfp_only [38;5;241m=[39m gfp [38;5;241m==[39m [38;5;124m"[39m[38;5;124monly[39m[38;5;124m"[39m
[0;32m    666[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m gfp_only:

File [1;32m~\Anaconda3\envs\OHBM_Course\Lib\site-packages\mne\utils\check.py:640[0m, in [0;36m_check_if_nan[1;34m(data, msg)[0m
[0;32m    638[0m [38;5;250m[39m[38;5;124;03m"""Raise if any of the values are NaN."""[39;00m
[0;32m    639[0m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m np[38;5;241m.[39misfinite(data)[38;5;241m.[39mall():
[1;32m--> 640[0m     [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m([38;5;124m"[39m[38;5;124mSome of the values [39m[38;5;132;01m{}[39;00m[38;5;124m are NaN.[39m[38;5;124m"[39m[38;5;241m.[39mformat(msg))

[1;31mValueError[0m: Some of the values  to be plotted are NaN.

