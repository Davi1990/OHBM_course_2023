

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3) Applications 2: Clinical &#8212; OHBM Educational Course on Whole-brain Models</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'materials/3_Clinical';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="2) Applications 1: Systems/Cognitive" href="2_Systems_Cognitive.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../abstract.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../abstract.html">
                    Principles and Applications of Whole-brain, Connectome-based Models of Brain Dynamics: An Educational Course
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lectures.html">Lectures</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../materials.html">Materials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_Background_Theory.html">1) Background / Theory</a></li>







<li class="toctree-l2"><a class="reference internal" href="2_Systems_Cognitive.html">2) Applications 1: Systems/Cognitive <br/></a></li>










<li class="toctree-l2 current active"><a class="current reference internal" href="#">3) Applications 2: Clinical</a></li>









</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/GriffithsLab/OHBM-whole-brain-modelling-course/blob/master/docs/materials/3_Clinical.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/GriffithsLab/OHBM-whole-brain-modelling-course" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/GriffithsLab/OHBM-whole-brain-modelling-course/issues/new?title=Issue%20on%20page%20%2Fmaterials/3_Clinical.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/materials/3_Clinical.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>3) Applications 2: Clinical</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">3) Applications 2: Clinical</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#sessions-s-speakers"><strong>Sessions’s Speakers</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#contents">Contents</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#linking-mechanistic-multi-scale-brain-simulation-and-knowledge-technology-towards-a-holistic-understanding-of-alzheimers-disease"><strong>Linking mechanistic multi-scale brain simulation and knowledge technology towards a holistic understanding of Alzheimer’s Disease</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cause-and-effect-model-for-abeta-sigmoidal-transfer-function-stefanovski-et-al-2019">Cause-and-effect model for Abeta: sigmoidal transfer function (Stefanovski et al. 2019)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#load-individual-abeta-pet-suvrs">Load individual Abeta PET SUVRs</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-histogram-of-molecular-input-data">Visualize histogram of molecular input data</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#available-parameters-are">Available parameters are:</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#whole-brain-modeling-for-epilepsy-diagnosis"><strong>Whole brain modeling for epilepsy diagnosis</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-synthetic-data"><strong>Generate Synthetic Data</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">Conclusions</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gdown</span>
<span class="n">gdown</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;1Dt_ze8lf_hnOv9gNCpLNJKq6rIUhFvoA&#39;</span><span class="p">)</span>
<span class="o">!</span>unzip<span class="w"> </span>03_Clinical-20230717T233033Z-001.zip
<span class="o">!</span>rm<span class="w"> </span>03_Clinical-20230717T233033Z-001.zip
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading...
From (uriginal): https://drive.google.com/uc?id=1Dt_ze8lf_hnOv9gNCpLNJKq6rIUhFvoA
From (redirected): https://drive.google.com/uc?id=1Dt_ze8lf_hnOv9gNCpLNJKq6rIUhFvoA&amp;confirm=t&amp;uuid=d1348c06-b87c-40f3-8339-7f6637469dae
To: C:\Users\davide_momi\Desktop\Dave\repo\WBM_educational_course\wbm_book\materials\03_Clinical-20230717T233033Z-001.zip
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0%|          | 0.00/70.9M [00:00&lt;?, ?B/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1%|          | 524k/70.9M [00:00&lt;00:17, 3.95MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1%|▏         | 1.05M/70.9M [00:00&lt;00:16, 4.13MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  4%|▎         | 2.62M/70.9M [00:00&lt;00:09, 7.51MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  5%|▌         | 3.67M/70.9M [00:00&lt;00:08, 7.76MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  7%|▋         | 4.72M/70.9M [00:00&lt;00:08, 7.92MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  8%|▊         | 5.77M/70.9M [00:00&lt;00:08, 8.01MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 10%|▉         | 6.82M/70.9M [00:00&lt;00:07, 8.01MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 11%|█         | 7.86M/70.9M [00:01&lt;00:07, 7.97MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 13%|█▎        | 8.91M/70.9M [00:01&lt;00:07, 7.96MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 14%|█▍        | 9.96M/70.9M [00:01&lt;00:07, 7.93MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 16%|█▌        | 11.0M/70.9M [00:01&lt;00:07, 7.95MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 17%|█▋        | 12.1M/70.9M [00:01&lt;00:07, 7.91MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 18%|█▊        | 13.1M/70.9M [00:01&lt;00:07, 7.92MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 20%|█▉        | 14.2M/70.9M [00:01&lt;00:07, 7.91MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 21%|██▏       | 15.2M/70.9M [00:01&lt;00:07, 7.92MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 23%|██▎       | 16.3M/70.9M [00:02&lt;00:06, 7.92MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 24%|██▍       | 17.3M/70.9M [00:02&lt;00:06, 7.91MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 26%|██▌       | 18.4M/70.9M [00:02&lt;00:06, 7.90MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 27%|██▋       | 19.4M/70.9M [00:02&lt;00:06, 7.85MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 29%|██▉       | 20.4M/70.9M [00:02&lt;00:06, 7.94MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 30%|███       | 21.5M/70.9M [00:02&lt;00:06, 7.93MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 32%|███▏      | 22.5M/70.9M [00:02&lt;00:06, 7.76MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 33%|███▎      | 23.6M/70.9M [00:03&lt;00:06, 7.04MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 35%|███▍      | 24.6M/70.9M [00:03&lt;00:06, 6.64MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 36%|███▋      | 25.7M/70.9M [00:03&lt;00:07, 6.40MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 38%|███▊      | 26.7M/70.9M [00:03&lt;00:07, 6.19MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 39%|███▉      | 27.8M/70.9M [00:03&lt;00:07, 6.08MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 41%|████      | 28.8M/70.9M [00:03&lt;00:06, 6.07MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 42%|████▏     | 29.9M/70.9M [00:04&lt;00:06, 6.58MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 44%|████▎     | 30.9M/70.9M [00:04&lt;00:06, 6.50MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 45%|████▌     | 32.0M/70.9M [00:04&lt;00:05, 7.12MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 47%|████▋     | 33.0M/70.9M [00:04&lt;00:05, 7.11MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 48%|████▊     | 34.1M/70.9M [00:04&lt;00:05, 6.93MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 50%|████▉     | 35.1M/70.9M [00:04&lt;00:05, 6.80MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 51%|█████     | 36.2M/70.9M [00:05&lt;00:05, 6.70MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 53%|█████▎    | 37.2M/70.9M [00:05&lt;00:06, 5.40MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 54%|█████▍    | 38.3M/70.9M [00:05&lt;00:05, 6.01MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 55%|█████▌    | 39.3M/70.9M [00:05&lt;00:04, 6.55MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 57%|█████▋    | 40.4M/70.9M [00:05&lt;00:04, 6.73MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 58%|█████▊    | 41.4M/70.9M [00:05&lt;00:04, 6.98MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 60%|█████▉    | 42.5M/70.9M [00:05&lt;00:03, 7.26MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 61%|██████▏   | 43.5M/70.9M [00:06&lt;00:03, 7.00MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 63%|██████▎   | 44.6M/70.9M [00:06&lt;00:03, 7.11MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 64%|██████▍   | 45.6M/70.9M [00:06&lt;00:03, 7.00MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 66%|██████▌   | 46.7M/70.9M [00:06&lt;00:03, 6.91MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 67%|██████▋   | 47.7M/70.9M [00:06&lt;00:03, 6.94MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 69%|██████▉   | 48.8M/70.9M [00:06&lt;00:03, 7.27MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 70%|███████   | 49.8M/70.9M [00:06&lt;00:02, 7.51MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 72%|███████▏  | 50.9M/70.9M [00:07&lt;00:02, 7.73MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 73%|███████▎  | 51.9M/70.9M [00:07&lt;00:02, 7.83MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 75%|███████▍  | 53.0M/70.9M [00:07&lt;00:02, 7.81MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 76%|███████▌  | 54.0M/70.9M [00:07&lt;00:02, 7.57MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 78%|███████▊  | 55.1M/70.9M [00:07&lt;00:01, 8.05MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 79%|███████▉  | 56.1M/70.9M [00:07&lt;00:01, 7.99MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 81%|████████  | 57.1M/70.9M [00:07&lt;00:01, 7.98MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 82%|████████▏ | 58.2M/70.9M [00:08&lt;00:01, 7.95MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 84%|████████▎ | 59.2M/70.9M [00:08&lt;00:01, 7.93MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 85%|████████▌ | 60.3M/70.9M [00:08&lt;00:01, 7.77MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 87%|████████▋ | 61.3M/70.9M [00:08&lt;00:01, 7.93MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 88%|████████▊ | 62.4M/70.9M [00:08&lt;00:01, 7.99MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 90%|████████▉ | 63.4M/70.9M [00:08&lt;00:00, 7.94MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 91%|█████████ | 64.5M/70.9M [00:08&lt;00:00, 7.94MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 92%|█████████▏| 65.5M/70.9M [00:08&lt;00:00, 7.77MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 94%|█████████▍| 66.6M/70.9M [00:09&lt;00:00, 7.98MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 95%|█████████▌| 67.6M/70.9M [00:09&lt;00:00, 7.93MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 97%|█████████▋| 68.7M/70.9M [00:09&lt;00:00, 7.93MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 98%|█████████▊| 69.7M/70.9M [00:09&lt;00:00, 7.95MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|█████████▉| 70.8M/70.9M [00:09&lt;00:00, 7.79MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 70.9M/70.9M [00:09&lt;00:00, 7.34MB/s]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>^C
Archive:  03_Clinical-20230717T233033Z-001.zip
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>replace 03_Clinical/Dollomaja/connectivity.vep.zip? [y]es, [n]o, [A]ll, [N]one, [r]ename: 
</pre></div>
</div>
</div>
</div>
<p><em><strong>Dr. Davide Momi</strong></em><br/>
​———–<br/>
Post-Doctoral Research Fellow<br/>
Whole Brain Modelling Group<br/>
Krembil Centre for Neuroinformatics - CAMH<br/>
250 College St., Toronto, ON M5T 1R8<br/>
website: <a class="reference external" href="https://davi1990.github.io/">https://davi1990.github.io/</a><br/>
Twitter: &#64;DaveMomi<br/>
<br/>
<br/>
<em><strong>Borana Dollomaja</strong></em><br/>
​———–<br/>
Ph.D. Candidate<br/>
Institut de Neurosciences des Systèmes<br/>
<br/>
<br/>
<em><strong>Dr. Leon Stefanovski</strong></em><br/>
​———–<br/>
Medical Doctor and ​Post-Doctoral Research Fellow<br/>
Berlin Institute of Health (BIH)<br/>
Charité Universitätsmedizin Berlin<br/>
<br/></p>
<div class="section" id="applications-2-clinical">
<h1>3) Applications 2: Clinical<a class="headerlink" href="#applications-2-clinical" title="Permalink to this heading">#</a></h1>
</div>
<div class="section" id="sessions-s-speakers">
<h1><strong>Sessions’s Speakers</strong><a class="headerlink" href="#sessions-s-speakers" title="Permalink to this heading">#</a></h1>
<p><img alt="alt text" src="https://drive.google.com/uc?id=13bU3-qoaFWU5Y__yY-Cprulp9zg4DHlG" /></p>
<hr class="docutils" />
</div>
<div class="section" id="contents">
<h1>Contents<a class="headerlink" href="#contents" title="Permalink to this heading">#</a></h1>
<p><span class="xref myst">Overview</span><br />
<span class="xref myst">Setup</span><br />
<span class="xref myst">Modeling Alzheimer</span><br />
<span class="xref myst">Modeling Epilepsy</span><br />
<span class="xref myst">Conclusions</span><br />
<span class="xref myst">References</span></p>
</div>
<div class="section" id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h1>
<p>During this final session of the Educational Course, our focus will be on the significance of whole-brain modeling in clinical settings. The tutorial will demonstrate how simulating brain dynamics can reveal mechanisms related to the pathology that cannot be measured in vivo. Additionally, the utilization of whole-brain modeling holds great importance in identifying disease biomarkers for early-stage diagnosis and classification.</p>
<p>Spefically we will delve into two diseases:</p>
<ol class="arabic simple">
<li><p><strong>Alzheimer’s disease</strong> and</p></li>
<li><p><strong>Epilepsy</strong>.</p></li>
</ol>
<p>Demonstrations are run using mainly the <a class="reference external" href="https://thevirtualbrain.org/tvb/zwei"><strong>The Virtual Brain Toolbox</strong></a> who has the purpose of offering modern tools to the Neurosciences community, for computing, simulating and analyzing functional and structural data of human brains, brains modeled at the level of population of neurons.</p>
</div>
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this heading">#</a></h1>
<p>If you are running this notebook in Google Colab, you will need to install some packages. If you are running in a more standard python environment, you need to ensure that these packages are installed externally (typically with <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">&lt;package&gt;</span></code> on the command line).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="o">!{</span>sys.executable<span class="o">}</span><span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>mne<span class="w"> </span>&gt;<span class="w"> </span>/dev/null
<span class="o">!{</span>sys.executable<span class="o">}</span><span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>nilearn<span class="w"> </span>&gt;<span class="w"> </span>/dev/null
<span class="o">!{</span>sys.executable<span class="o">}</span><span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>nibabel<span class="w"> </span>&gt;<span class="w"> </span>/dev/null
<span class="o">!{</span>sys.executable<span class="o">}</span><span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>tvb-data<span class="w"> </span>&gt;<span class="w"> </span>/dev/null
<span class="o">!{</span>sys.executable<span class="o">}</span><span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>tvb-library<span class="w"> </span>&gt;<span class="w"> </span>/dev/null

<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;//content/03_Clinical&#39;</span><span class="p">)</span>

<span class="c1"># @title Install dependencies</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pylab</span> inline

<span class="kn">from</span> <span class="nn">tvb.simulator.lab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">tvb.basic.neotraits.api</span> <span class="kn">import</span> <span class="n">NArray</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Range</span><span class="p">,</span> <span class="n">Final</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.io</span> <span class="k">as</span> <span class="nn">sio</span>
<span class="kn">import</span> <span class="nn">scipy.signal</span> <span class="k">as</span> <span class="nn">sig</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="k">as</span> <span class="nn">mp</span>
<span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">tvb.simulator.plot.phase_plane_interactive</span> <span class="kn">import</span> <span class="n">PhasePlaneInteractive</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>

<span class="c1"># @title Importage</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Populating the interactive namespace from numpy and matplotlib
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.10/dist-packages/tvb/datatypes/surfaces.py:60: UserWarning: Geodesic distance module is unavailable; some functionality for surfaces will be unavailable.
  warnings.warn(msg)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="linking-mechanistic-multi-scale-brain-simulation-and-knowledge-technology-towards-a-holistic-understanding-of-alzheimers-disease">
<h1><strong>Linking mechanistic multi-scale brain simulation and knowledge technology towards a holistic understanding of Alzheimer’s Disease</strong><a class="headerlink" href="#linking-mechanistic-multi-scale-brain-simulation-and-knowledge-technology-towards-a-holistic-understanding-of-alzheimers-disease" title="Permalink to this heading">#</a></h1>
<p>In this part we will explore how the how computational multi-scale brain modeling can links phenomena of different scales and therefore identifies potential disease mechanisms of Alzheimer’s disease (AD) as demonstrated in <a class="reference external" href="https://www.frontiersin.org/articles/10.3389/fncom.2019.00054/full">Stefanovski et al. 2019</a></p>
<p><img alt="alt text" src="https://www.frontiersin.org/files/Articles/463671/fncom-13-00054-HTML/image_m/fncom-13-00054-g001.jpg" /></p>
</div>
<div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h1>
<p>Here we present an approach to link molecular information to large-scale simulations of The Virtual Brain.
This script allows the construction of cause-and-effect models that transfer regional information (of any kind)
into a shift of a paramter of the regional dynamic model of The Virtual Brain.</p>
<p>Parts of the empirical data were obtained from the Alzheimer’s Disease Neuroimaging Initiative (ADNI) database
(<a class="reference external" href="http://adni.loni.usc.edu">adni.loni.usc.edu</a>). Here, we only present group-based data for testing purposes. The ADNI was launched in 2003 as a public-private partnership, led by Principal Investigator Michael W. Weiner. The primary goal of ADNI has been to test whether
serial MRI, PET, other biological markers, and clinical and neuropsychological assessment can be
combined to measure the progression of MCI and early AD. For up-to-date information, see <a class="reference external" href="http://www.adni-info.org">www.adni-info.org</a>.
ADNI acknowledgements:
<a class="reference external" href="http://adni.loni.usc.edu/wp-content/themes/freshnews-dev-v2/documents/policy/ADNI_Acknowledgement_List%205-29-18.pdf">http://adni.loni.usc.edu/wp-content/themes/freshnews-dev-v2/documents/policy/ADNI_Acknowledgement_List 5-29-18.pdf</a>’</p>
<p><strong>Requirements</strong></p>
<p>The example code in this script makes use of molecular information in simple arrays.
Each array consists of a value for different amounts of brain regions, namely</p>
<p>180 values for the left hemisphere as an txt-file (Glasser)
180 values for the right hemisphere as an txt-file (Glasser)
19 values for subcortical regions as an txt-file (Fischl)</p>
<p>Some of these maps have only unilateral cortical information and therefor eonly 180 values.</p>
<p>Necessary data is moreover:
1 structural connectivity matrix in .txt format
for each subject 1 leadfield matrix (if EEG calculation is desired)</p>
<p>NOTE: we provide an artificial surrogate dataset that is created by averaging empirical data in ADNI as molecular input as well as an averaged stuctrual connecitivty matrix and a leadfield matrix For the original dataset of ADNI, please apply for access to ADNI-3: <a class="reference external" href="http://adni.loni.usc.edu/data-samples/access-data/">http://adni.loni.usc.edu/data-samples/access-data/</a></p>
<p>Of course, any other form of an array is also suitable, as well as other atlases.
In this case, you would need to adapt the code accordingly - including the used strcutural connectivity.</p>
<p><strong>Atlas</strong></p>
<p>We make use of two brain atlases: Glasser for cortical areas and Fischl for subcortical areas.</p>
<p>Glasser atlas:
Glasser, M. F., T. S. Coalson, E. C. Robinson, C. D. Hacker, J. Harwell, E. Yacoub,
K. Ugurbil, J. Andersson, C. F. Beckmann, M. Jenkinson, S. M. Smith and D. C. Van Essen (2016).
“A multi-modal parcellation of human cerebral cortex.” Nature 536(7615): 171-178.</p>
<p>Subcortical Fischl atlas (from freesurfer):
Fischl, B., D. H. Salat, E. Busa, M. Albert, M. Dieterich, C. Haselgrove, A. van der Kouwe,
R. Killiany, D. Kennedy, S. Klaveness, A. Montillo, N. Makris, B. Rosen and A. M. Dale (2002).
“Whole brain segmentation: automated labeling of neuroanatomical structures in the human brain.”
Neuron 33(3): 341-355.</p>
<p><strong>Transfer functions</strong></p>
<p>As a general concept, we introduce so-called transfer functions to translate the effect of a molecular array into a shift of dynamic parameters in TVB’s neural mass models. In the follwoing, we will introduce some common forms for transfer functions.</p>
<p><strong>Sigmoid</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sigmoidal functions are common in natural relationships.</span>
<span class="c1"># Their most important characteristics are an upper and lower limit and the steepness of the curve inbetween</span>
<span class="c1"># The function will transform an input variable (from the arrays) into a parameter of TVB</span>

<span class="n">y_min</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1"># y_min is the lower asymptote of the sigmoid with</span>

<span class="n">y_max</span>  <span class="o">=</span> <span class="mi">5</span>
<span class="c1"># y_max is the differnece between lower and upper asymptote of the sigmoid</span>
<span class="c1"># y_max + y_min is the upper asymptote of the sigmoid</span>

<span class="n">x_1</span> <span class="o">=</span> <span class="mi">4</span>
<span class="c1"># x_1 is the cut-off x value from which on the sigmoid increases / decreases</span>

<span class="n">x_2</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1"># x_2 is the x value where the sigmoid gets near to the second asymptote</span>
<span class="c1"># If x_1 &gt; x_2, the sigmoid increases</span>
<span class="c1"># If x_2 &gt; x_1, the sigmoid decreases</span>

<span class="n">c</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="c1"># the steepness k can be adjusted by the parameter c</span>

<span class="c1"># x_0 (value of  sigmoid midpoint) is derived from the variables above</span>

<span class="k">def</span> <span class="nf">transform_sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_max</span><span class="p">,</span> <span class="n">y_min</span><span class="p">,</span> <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">):</span>
    <span class="n">x_0</span>       <span class="o">=</span> <span class="p">(</span><span class="n">x_2</span> <span class="o">-</span> <span class="n">x_1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>  <span class="o">+</span> <span class="n">x_1</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span> <span class="n">y_max</span> <span class="o">/</span> <span class="p">((</span><span class="n">y_min</span><span class="o">+</span><span class="n">c</span><span class="p">)</span> <span class="o">-</span> <span class="n">y_min</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">x_2</span> <span class="o">-</span> <span class="n">x_0</span><span class="p">)</span>
    <span class="k">return</span>  <span class="n">y_max</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_0</span><span class="p">)</span> <span class="p">))</span> <span class="o">+</span> <span class="n">y_min</span>

<span class="c1"># visualize</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">transform_sigmoid</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">y_max</span><span class="p">,</span> <span class="n">y_min</span><span class="p">,</span> <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Sigmoidal transfer function&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;18&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">1.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/955040e4d032971003c21a131c9c629225462935babe55ac1ffa883eba80ef58.png" src="../_images/955040e4d032971003c21a131c9c629225462935babe55ac1ffa883eba80ef58.png" />
</div>
</div>
<p>Linear</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Linear functions are reflecting simple relationships.</span>
<span class="c1"># As they do not have an upper or lower limit, for relationships with these limits and a linear dependency inbetween</span>
<span class="c1"># consider a sigmoid with adequate steepness</span>
<span class="c1"># General form: y = mx + c</span>

<span class="n">m</span> <span class="o">=</span> <span class="mi">3</span>
<span class="c1"># m is the increment of the linear function</span>

<span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="c1"># c is the ordinate intercept of the function</span>

<span class="k">def</span> <span class="nf">transform_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="k">return</span>  <span class="n">m</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">c</span>

<span class="c1"># visualize</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">transform_linear</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">c</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Linear transfer function&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;18&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">1.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8dedd9af2c5b120ffa8ef643594543a892aca1d07461d798048143838961a58f.png" src="../_images/8dedd9af2c5b120ffa8ef643594543a892aca1d07461d798048143838961a58f.png" />
</div>
</div>
<p><strong>Other Transfer Functions</strong></p>
<p>In general, there are no restrictions of what mathematical function you can use to translate an empirical input into a parameter fo the simulation - as, e.g., logarithmic or polynomial functions. We recommend, however, to base the choice of a transfer function clearly on a biological concept, as this will increase the real-world usability.</p>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="cause-and-effect-model-for-abeta-sigmoidal-transfer-function-stefanovski-et-al-2019">
<h1>Cause-and-effect model for Abeta: sigmoidal transfer function (Stefanovski et al. 2019)<a class="headerlink" href="#cause-and-effect-model-for-abeta-sigmoidal-transfer-function-stefanovski-et-al-2019" title="Permalink to this heading">#</a></h1>
<p>As a first example use case, we will reproduce simulations from our former study and show some core results.</p>
<p>In this study the regional burden of Amyloid beta (Abeta) is derived from AV-45 positrone emission tomography (PET)
A cause-and-effect model defines the inhibitory rate of each region as a function of the Abeta burden
This leads to an AD-specific slowing in local field potentials and EEG.</p>
<p>Please cite as:</p>
<p>Stefanovski, L., P. Triebkorn, A. Spiegler, M.-A. Diaz-Cortes, A. Solodkin, V. Jirsa,
R. McIntosh and P. Ritter; for the Alzheimer’s disease Neuromigang Initiative (2019).
“Linking molecular pathways and large-scale computational modeling to assess candidate
disease mechanisms and pharmacodynamics in Alzheimer’s disease.” Frontiers in Computational Neuroscience 13(54).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Evidence for local effects of Abeta to inhibitory interneurons, e.g.:</span>
<span class="c1"># Ren et al. 2018 Scientific Reports: https://www.nature.com/articles/s41598-017-18729-5</span>
<span class="c1"># Ulrich 2015 J Neurosci: http://www.jneurosci.org/content/jneuro/35/24/9205.full.pdf</span>
<span class="c1"># Ripoli et al. 2014 J Neurosci: http://www.jneurosci.org/content/34/38/12893</span>
<span class="c1"># We define here the local inhibitory rate b as a function of Abeta burden:</span>

<span class="n">y_min</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="c1"># y_min is the lower asymptote of the sigmoid with a inhibitory time constant tau_i = 1/b = 50 ms</span>

<span class="n">y_max</span>  <span class="o">=</span> <span class="mf">0.05</span>
<span class="c1"># y_max is the differnece between lower and upper asymptote of the sigmoid</span>
<span class="c1"># y_min + y_max is the upper asymptote of the sigmoid at tau_i = 1/b = 14.29 ms</span>

<span class="n">x_1</span> <span class="o">=</span> <span class="mf">1.4</span>
<span class="c1"># x_1 is the cut-off SUVR from which on the sigmoid decreases,</span>
<span class="c1"># see Jack et al. 2014 Lancet Neurol: https://www.ncbi.nlm.nih.gov/pubmed/25201514</span>

<span class="n">x_2</span> <span class="o">=</span> <span class="mf">2.65</span>
<span class="c1"># x_2 is the 95th perecentile of Abeta SUVRs in the original study population</span>

<span class="n">c</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="c1"># to achieve almost linear decrement between x_1 and x_2</span>

<span class="c1"># visualize</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">transform_sigmoid</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">y_max</span><span class="p">,</span> <span class="n">y_min</span><span class="p">,</span> <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Abeta SUVR&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Time constant&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Abeta: Sigmoidal transfer function&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;18&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">1.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3001ba9fbe01e4d0b6fc69e5279f75bcc2281a4d835d2bb0d639aaf6ba8873bd.png" src="../_images/3001ba9fbe01e4d0b6fc69e5279f75bcc2281a4d835d2bb0d639aaf6ba8873bd.png" />
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="load-individual-abeta-pet-suvrs">
<h1>Load individual Abeta PET SUVRs<a class="headerlink" href="#load-individual-abeta-pet-suvrs" title="Permalink to this heading">#</a></h1>
<p>Have an initial look to the PET arrays for the groups AD, MCI ad HC:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># As an example, we will show how to load the molecular data with PET data</span>
<span class="c1"># here you can select the subjects you want to simulate</span>

<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;/content//03_Clinical/Stefanovski&#39;</span><span class="p">)</span>

<span class="n">DX</span> <span class="o">=</span> <span class="s2">&quot;AD&quot;</span> <span class="c1"># one of AD, MCI or HC</span>
<span class="n">modality</span><span class="o">=</span><span class="s2">&quot;Amyloid&quot;</span>
<span class="n">pet_path</span><span class="o">=</span><span class="s2">&quot;./_&quot;</span><span class="o">+</span><span class="n">DX</span>
<span class="n">RH_pet</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">pet_path</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">DX</span><span class="o">+</span><span class="s2">&quot;_RH.txt&quot;</span><span class="p">)</span>
<span class="n">LH_pet</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">pet_path</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">DX</span><span class="o">+</span><span class="s2">&quot;_LH.txt&quot;</span><span class="p">)</span>
<span class="n">subcort_pet</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">pet_path</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">DX</span><span class="o">+</span><span class="s2">&quot;_subcortical.txt&quot;</span><span class="p">)</span>
<span class="n">abeta_burden</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">LH_pet</span><span class="p">,</span><span class="n">RH_pet</span><span class="p">,</span><span class="n">subcort_pet</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="visualize-histogram-of-molecular-input-data">
<h2>Visualize histogram of molecular input data<a class="headerlink" href="#visualize-histogram-of-molecular-input-data" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">abeta_burden</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#0504aa&#39;</span><span class="p">,</span>
                            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Abeta SUVR&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Regions&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Abeta histogram for &quot;</span><span class="o">+</span><span class="n">DX</span><span class="o">+</span><span class="s2">&quot; subjects&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;18&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">1.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d9ca9689fc1b3e499127e1d81be86de625d15d4c0c186aeebab20f17430f5d1b.png" src="../_images/d9ca9689fc1b3e499127e1d81be86de625d15d4c0c186aeebab20f17430f5d1b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load strcutural connectivity matrix</span>
<span class="n">SCnorm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;./Connectome/avg_healthy_normSC_mod.txt&quot;</span><span class="p">)</span>

<span class="c1"># For simulations without the 19 subcortical regions, use SCnorm[0:360,0:360]</span>

<span class="c1"># Visualization of the matrix</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">SCnorm</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Regions&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Regions&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Structural Connectivity&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;18&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">1.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ce8decba71a55d2ee127eff7890a3b710ff5965b10b538360830210e0a5fc9c3.png" src="../_images/ce8decba71a55d2ee127eff7890a3b710ff5965b10b538360830210e0a5fc9c3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load leadfield matrix</span>
<span class="n">lf_mat</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="s2">&quot;./_&quot;</span><span class="o">+</span><span class="n">DX</span><span class="o">+</span><span class="s2">&quot;/leadfield.mat&quot;</span><span class="p">)[</span><span class="s2">&quot;lf_sum&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Neural Mass Model selection</strong></p>
<p>Here, we make use of the Jansen-Rit model. It is origianlly described in:</p>
<p><em>Jansen, B. H. and V. G. Rit (1995). “Electroencephalogram and visual evoked potential generation in a mathematical model of coupled cortical columns.” Biol Cybern 73(4): 357-366.</em></p>
<p>and in</p>
<p><em>Jansen BH, Zouridakis G, and Brandt M. A neurophysiologically-based mathematical model of flash visual evoked potentials. Biol. Cybern. 68, 275:283, 1993.</em></p>
<p>A description of its implementation to TVB, as well as a comparison with other neural mass models, can be found in:</p>
<p><em>Sanz-Leon, P., S. A. Knock, A. Spiegler and V. K. Jirsa (2015). “Mathematical framework for large-scale brain network modeling in The Virtual Brain.” NeuroImage 111: 385-430.</em></p>
<p>It makes use of three neural populations: pyramidal cells, excitatory internueons and inhibitory interneurons.</p>
<p><img alt="alt text" src="https://www.frontiersin.org/files/Articles/463671/fncom-13-00054-HTML/image_m/fncom-13-00054-g002.jpg" /></p>
<p>Notation in the figure according to Stefanovski et al. 2019.</p>
<p>The equations of the Jansen-Rit model as implemented in TVB are the following:
\begin{equation}
\dot{y_{0}} = y_{3} \
\dot{y_{3}} = Aa Sigm(y_{1} -  y_{2}) - 2a y_{3} - a^{2} y_{0} \
\dot{y_{1}} = y_{4} \
\dot{y_{4}} = Aa [p(t) + \alpha_2 J Sigm[\alpha_1 J y_0] + lrc + src] -2a y_{4} - a^{2} y_{1}\
\dot{y_{2}} = y_{5} \
\dot{y_5} = Bb (\alpha_4 J Sigm[\alpha_3 J y_{0}]) - 2b y_{5} - b^{2} y_{2} \
\end{equation}</p>
<p>with
\begin{equation}
Sigm(\nu) = \frac{2 \nu_{max}}{1 + \exp^{r(\nu_{0} - \nu)}}
\end{equation}</p>
<p>Source code in TVB can be found here:</p>
<p><a class="github reference external" href="https://github.com/the-virtual-brain/tvb-root/blob/master/scientific_library/tvb/simulator/models/jansen_rit.py">the-virtual-brain/tvb-root</a></p>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="available-parameters-are">
<h1>Available parameters are:<a class="headerlink" href="#available-parameters-are" title="Permalink to this heading">#</a></h1>
<p><span class="math notranslate nohighlight">\(A\)</span> = Maximum amplitude of EPSP [mV]. Also called average synaptic gain.</p>
<p><span class="math notranslate nohighlight">\(B\)</span> = Maximum amplitude of IPSP [mV]. Also called average synaptic gain.</p>
<p><span class="math notranslate nohighlight">\(a\)</span> = Reciprocal of the time constant of passive membrane and all other spatially distributed delays in the dendritic network [ms^-1]. Also called average synaptic time constant.</p>
<p><span class="math notranslate nohighlight">\(b\)</span> = Reciprocal of the time constant of passive membrane and all
other spatially distributed delays in the dendritic network [ms^-1].
Also called average synaptic time constant.</p>
<p><span class="math notranslate nohighlight">\(v_0\)</span> = Firing threshold (PSP) for which a 50% firing rate is <a class="reference external" href="http://achieved.In">achieved.In</a> other words, it is the value of the average membrane potential corresponding to the inflection point of the sigmoid [mV]. The usual value for this parameter is 6.0.</p>
<p><span class="math notranslate nohighlight">\(\nu_{max}\)</span> = Determines the maximum firing rate of the neural population [s^-1].</p>
<p><span class="math notranslate nohighlight">\(r\)</span> = Steepness of the sigmoidal transformation [mV^-1].</p>
<p><span class="math notranslate nohighlight">\(J\)</span> = Average number of synapses between populations.</p>
<p><span class="math notranslate nohighlight">\(a_1\)</span> = Average probability of synaptic contacts in the feedback excitatory loop.</p>
<p><span class="math notranslate nohighlight">\(a_2\)</span> = Average probability of synaptic contacts in the slow feedback excitatory loop.</p>
<p><span class="math notranslate nohighlight">\(a_3\)</span> = Average probability of synaptic contacts in the feedback inhibitory loop.</p>
<p><span class="math notranslate nohighlight">\(a_4\)</span> = Average probability of synaptic contacts in the slow feedback inhibitory loop.</p>
<p><span class="math notranslate nohighlight">\(p_{min}\)</span> = Minimum input firing rate.</p>
<p><span class="math notranslate nohighlight">\(p_{max}\)</span> = Maximum input firing rate.</p>
<p><span class="math notranslate nohighlight">\(\mu\)</span> = Mean input firing rate</p>
<p>In the example study, we used b, the inhibitory membrane constant, to be modulated by local Abeta concentration.
This introduces further heterogenity to produce oscialltions in the absence of artificial noise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">transform_sigmoid</span><span class="p">(</span><span class="n">abeta_burden</span><span class="p">,</span> <span class="n">y_max</span><span class="p">,</span> <span class="n">y_min</span><span class="p">,</span> <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Jansen-Rit Model Configuration</strong></p>
<p>First, we build an extended version of the Jansen-Rit model to obrain the outgoing projections, represented by the differnece between state variables of pyramidal cells and inhibitory interneurons:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ExtendedJansenRit</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">JansenRit</span><span class="p">):</span>
    <span class="n">variables_of_interest</span> <span class="o">=</span> <span class="n">List</span><span class="p">(</span>
        <span class="n">of</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Variables watched by Monitors&quot;</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="p">([</span><span class="s2">&quot;y1-y2&quot;</span><span class="p">]),</span>
        <span class="n">default</span><span class="o">=</span><span class="p">([</span><span class="s2">&quot;y1-y2&quot;</span><span class="p">]))</span>
<span class="n">ExtendedJansenRit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead><h3>ExtendedJansenRit</h3></thead>
<tbody>
<tr><td colspan="2"><p><div class="document" id="ddd556bc-2745-11ee-9f2f-0242ac1c000c">
<blockquote>
<p>The dynamic equations were taken from <a href="#id2"><span class="problematic" id="id1">[JR_1995]_</span></a></p>
<div class="math">
\begin{align*}
\dot{y_0} &amp;= y_3 \\
\dot{y_3} &amp;= A a\,S[y_1 - y_2] - 2a\,y_3 - 2a^2\, y_0 \\
\dot{y_1} &amp;= y_4\\
\dot{y_4} &amp;= A a \,[p(t) + \alpha_2 J S[\alpha_1 J\,y_0]+ c_0]
            -2a\,y - a^2\,y_1 \\
\dot{y_2} &amp;= y_5 \\
\dot{y_5} &amp;= B b (\alpha_4 J\, S[\alpha_3 J \,y_0]) - 2 b\, y_5
            - b^2\,y_2 \\
S[v] &amp;= \frac{2\, \nu_{max}}{1 + \exp^{r(v_0 - v)}}
\end{align*}
</div>
<p><span class="math">\(p(t)\)</span> can be any arbitrary function, including white noise or
random numbers taken from a uniform distribution, representing a pulse
density with an amplitude varying between 120 and 320</p>
<p>For Evoked Potentials, a transient component of the input,
representing the impulse density attribuable to a brief visual input is
applied. Time should be in seconds.</p>
<div class="math">
\begin{align*}
p(t) = q\,(\frac{t}{w})^n \, \exp{-\frac{t}{w}} \\
q = 0.5 \\
n = 7 \\
w = 0.005 [s]
\end{align*}
</div>
</blockquote>
</div>
<script>MathJax.Hub.Queue(["Typeset", MathJax.Hub, "ddd556bc-2745-11ee-9f2f-0242ac1c000c"]);</script></p></td></tr>
<tr><th></th><th style="text-align:left;width:80%">value</th></tr>
<tr><td>A</td><td style="text-align:left;"><pre>3.25</pre></td></tr>
<tr><td>B</td><td style="text-align:left;"><pre>22.0</pre></td></tr>
<tr><td>J</td><td style="text-align:left;"><pre>135.0</pre></td></tr>
<tr><td>Type</td><td style="text-align:left;"><pre>ExtendedJansenRit</pre></td></tr>
<tr><td>a</td><td style="text-align:left;"><pre>0.1</pre></td></tr>
<tr><td>a_1</td><td style="text-align:left;"><pre>1.0</pre></td></tr>
<tr><td>a_2</td><td style="text-align:left;"><pre>0.8</pre></td></tr>
<tr><td>a_3</td><td style="text-align:left;"><pre>0.25</pre></td></tr>
<tr><td>a_4</td><td style="text-align:left;"><pre>0.25</pre></td></tr>
<tr><td>b</td><td style="text-align:left;"><pre>0.05</pre></td></tr>
<tr><td>gid</td><td style="text-align:left;"><pre>UUID('7cb2010a-cbb7-4a22-b315-c66523252b4d')</pre></td></tr>
<tr><td>mu</td><td style="text-align:left;"><pre>0.22</pre></td></tr>
<tr><td>nu_max</td><td style="text-align:left;"><pre>0.0025</pre></td></tr>
<tr><td>p_max</td><td style="text-align:left;"><pre>0.32</pre></td></tr>
<tr><td>p_min</td><td style="text-align:left;"><pre>0.12</pre></td></tr>
<tr><td>r</td><td style="text-align:left;"><pre>0.56</pre></td></tr>
<tr><td>state_variable_range</td><td style="text-align:left;"><pre>{'y0': array([-1.,  1.]), 'y1': array([-500.,  500.]), 'y2': array([-50.,  50.]), 'y3': array([-6.,  6.]), 'y4': array([-20.,  20.]), 'y5': array([-500.,  500.])}</pre></td></tr>
<tr><td>title</td><td style="text-align:left;"><pre>ExtendedJansenRit gid: 7cb2010a-cbb7-4a22-b315-c66523252b4d</pre></td></tr>
<tr><td>v0</td><td style="text-align:left;"><pre>5.52</pre></td></tr>
<tr><td>variables_of_interest</td><td style="text-align:left;"><pre>['y1-y2']</pre></td></tr>
</tbody></table></div></div>
</div>
<p>Second, we define the desired monitor, in this case the subsample monitor:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subsample</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">monitors</span><span class="o">.</span><span class="n">SubSample</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">subsample</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<span class="n">subsample</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead><h3>SubSample</h3></thead>
<tbody>
<tr><td colspan="2"><p><div class="document" id="e4cc4606-2745-11ee-9f2f-0242ac1c000c">
<blockquote>
Sub-samples or decimates the solution in time.</blockquote>
</div>
<script>MathJax.Hub.Queue(["Typeset", MathJax.Hub, "e4cc4606-2745-11ee-9f2f-0242ac1c000c"]);</script></p></td></tr>
<tr><th></th><th style="text-align:left;width:80%">value</th></tr>
<tr><td>Type</td><td style="text-align:left;"><pre>SubSample</pre></td></tr>
<tr><td>gid</td><td style="text-align:left;"><pre>UUID('e2f9debb-8f3d-49dd-813c-61cab8fc224c')</pre></td></tr>
<tr><td>period</td><td style="text-align:left;"><pre>5.0</pre></td></tr>
<tr><td>title</td><td style="text-align:left;"><pre>SubSample gid: e2f9debb-8f3d-49dd-813c-61cab8fc224c</pre></td></tr>
<tr><td>variables_of_interest</td><td style="text-align:left;"><pre>None</pre></td></tr>
</tbody></table></div></div>
</div>
<p>Third, we define the underlying structural connectivity. Here, we can use a pre-calculated SC provided as a zip-file, containing avreaged SC weights of healthy controls:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># omitting any time delay between regions</span>
<span class="n">white_matter</span> <span class="o">=</span> <span class="n">connectivity</span><span class="o">.</span><span class="n">Connectivity</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;/content/03_Clinical/Stefanovski/Connectome/SC.zip&#39;</span><span class="p">)</span>
<span class="n">white_matter</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<span class="n">white_matter</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table>
<thead><h3>Connectivity</h3></thead>
<tbody>

<tr><th></th><th style="text-align:left;width:80%">value</th></tr>
<tr><td>Number of connections</td><td style="text-align:left;"><pre>143641</pre></td></tr>
<tr><td>Number of regions</td><td style="text-align:left;"><pre>379</pre></td></tr>
<tr><td>Undirected</td><td style="text-align:left;"><pre>False</pre></td></tr>
<tr><td>areas</td><td style="text-align:left;"><pre> [min, median, max] = [0, 31, 279] dtype = float64 shape = (379,)</pre></td></tr>
<tr><td>tract_lengths</td><td style="text-align:left;"><pre> [min, median, max] = [0, 113.362, 249.288] dtype = float64 shape = (379, 379)</pre></td></tr>
<tr><td>tract_lengths (connections)</td><td style="text-align:left;"><pre> [min, median, max] = [0, 113.362, 249.288] dtype = float64 shape = (143641,)</pre></td></tr>
<tr><td>tract_lengths-non-zero</td><td style="text-align:left;"><pre> [min, median, max] = [7.83447, 119.175, 249.288] dtype = float64 shape = (131206,)</pre></td></tr>
<tr><td>weights</td><td style="text-align:left;"><pre> [min, median, max] = [3.31199e-11, 0.00084717, 0.00743068] dtype = float64 shape = (379, 379)</pre></td></tr>
<tr><td>weights-non-zero</td><td style="text-align:left;"><pre> [min, median, max] = [3.31199e-11, 0.00084717, 0.00743068] dtype = float64 shape = (143641,)</pre></td></tr>
</tbody></table></div></div>
</div>
<p>Now, we create random initial conditions for the simulation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4000</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">SCnorm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>And assess the modeling parameters:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.1085</span><span class="p">)</span>
<span class="n">jrm</span> <span class="o">=</span> <span class="n">ExtendedJansenRit</span><span class="p">(</span><span class="n">v0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">p_max</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">p_min</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span>
                       <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set up the simulator</span>
<span class="c1"># adjust the simulation_length to your needs/ available computation time</span>
<span class="c1"># in the paper a simulation_length of 120000 was used</span>
<span class="c1"># but only the 2nd minute was used in the analysis to cut out possible transients</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span>  <span class="n">connectivity</span><span class="o">=</span><span class="n">white_matter</span><span class="p">,</span>
                            <span class="n">model</span><span class="o">=</span><span class="n">jrm</span><span class="p">,</span>
                            <span class="n">coupling</span><span class="o">=</span><span class="n">coupling</span><span class="o">.</span><span class="n">SigmoidalJansenRit</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)),</span>
                            <span class="n">integrator</span><span class="o">=</span><span class="n">integrators</span><span class="o">.</span><span class="n">HeunDeterministic</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
                            <span class="n">conduction_speed</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                            <span class="n">monitors</span><span class="o">=</span><span class="p">[</span><span class="n">subsample</span><span class="p">],</span>
                            <span class="n">initial_conditions</span> <span class="o">=</span> <span class="n">init</span><span class="p">,</span>
                            <span class="n">simulation_length</span><span class="o">=</span><span class="mf">4000.0</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">configure</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Simulator</strong></p>
<p>There are two options for saving results: First, by saving each simulation in separate (one cell below). Second, by saving a concatenedn array (defiend in the visualization functions)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># if you whish to save the simulated timeseries (separate for each simulation)</span>
<span class="c1"># set save_timeseries_to_file to True and declare a path/folder in save_path</span>
<span class="n">save_timeseries_to_file</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">save_path</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># FC analysis</span>
<span class="c1"># bandpass filtering</span>
<span class="k">def</span> <span class="nf">butter_bandpass</span><span class="p">(</span><span class="n">lowcut</span><span class="p">,</span> <span class="n">highcut</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">nyq</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">fs</span>
    <span class="n">low</span> <span class="o">=</span> <span class="n">lowcut</span> <span class="o">/</span> <span class="n">nyq</span>
    <span class="n">high</span> <span class="o">=</span> <span class="n">highcut</span> <span class="o">/</span> <span class="n">nyq</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="p">[</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">],</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;band&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>

<span class="k">def</span> <span class="nf">butter_bandpass_filter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lowcut</span><span class="p">,</span> <span class="n">highcut</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="c1"># data should be shape [n_samples, n_regions]</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">butter_bandpass</span><span class="p">(</span><span class="n">lowcut</span><span class="p">,</span> <span class="n">highcut</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span>

<span class="c1"># phase locking</span>
<span class="k">def</span> <span class="nf">phase_locking_value</span><span class="p">(</span><span class="n">theta1</span><span class="p">,</span> <span class="n">theta2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39; theta1 and theta2 must be phase data in radians</span>
<span class="sd">    e.g. theta1 = np.angle(hilber(signal1))</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">complex_phase_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">theta1</span> <span class="o">-</span> <span class="n">theta2</span><span class="p">))</span>
    <span class="n">plv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">complex_phase_diff</span><span class="p">))</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">plv</span>

<span class="c1"># calculate a FC of phase locking values</span>
<span class="k">def</span> <span class="nf">calc_FC_PLV</span><span class="p">(</span><span class="n">EEG</span><span class="p">,</span><span class="n">low_freq</span><span class="p">,</span> <span class="n">high_freq</span><span class="p">,</span> <span class="n">fs</span><span class="p">):</span>
    <span class="n">EEG_filt</span> <span class="o">=</span> <span class="n">butter_bandpass_filter</span><span class="p">(</span><span class="n">EEG</span><span class="p">,</span> <span class="n">low_freq</span><span class="p">,</span> <span class="n">high_freq</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
    <span class="n">FC</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">EEG_filt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">EEG_filt</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">phase</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">hilbert</span><span class="p">(</span><span class="n">EEG_filt</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">EEG</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">EEG</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">plv</span> <span class="o">=</span> <span class="n">phase_locking_value</span><span class="p">(</span><span class="n">phase</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span><span class="n">phase</span><span class="p">[:,</span><span class="n">j</span><span class="p">])</span>
            <span class="n">FC</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">plv</span>
    <span class="k">return</span> <span class="n">FC</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_sim</span><span class="p">(</span><span class="n">global_coupling</span><span class="p">):</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">coupling</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">global_coupling</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

    <span class="n">subs</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">PSP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">subs</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])[</span><span class="mi">400</span><span class="p">:,:]</span> <span class="c1"># cut out first part of simulation due to possible transients</span>

    <span class="c1">##### Analyze PSP</span>
    <span class="c1"># analyze signal, get baseline and frequency</span>
    <span class="n">psp_baseline</span>  <span class="o">=</span> <span class="n">PSP</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">psp_f</span><span class="p">,</span> <span class="n">psp_pxx</span>      <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">periodogram</span><span class="p">(</span><span class="n">PSP</span><span class="p">[:,:]</span><span class="o">-</span><span class="n">psp_baseline</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">nfft</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">psp_Pxx</span>    <span class="o">=</span> <span class="n">psp_pxx</span><span class="o">.</span><span class="n">T</span>
    <span class="n">psp_peak_freq</span> <span class="o">=</span> <span class="n">psp_f</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">psp_pxx</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>

    <span class="c1">##### Analyze EEG</span>
    <span class="c1"># generate EEG by multiplication of PSP with lf_mat</span>
    <span class="n">EEG</span> <span class="o">=</span> <span class="n">lf_mat</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">PSP</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="c1"># EEG shape [n_samples x n_eeg_channels]</span>

    <span class="c1"># reference is mean signal, tranposing because trailing dimension of arrays must agree</span>
    <span class="n">EEG</span> <span class="o">=</span> <span class="p">(</span><span class="n">EEG</span><span class="o">.</span><span class="n">T</span> <span class="o">-</span> <span class="n">EEG</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

    <span class="c1"># analyze signal, get baseline and frequency</span>
    <span class="n">eeg_baseline</span> <span class="o">=</span> <span class="n">EEG</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">EEG</span> <span class="o">=</span> <span class="n">EEG</span> <span class="o">-</span> <span class="n">EEG</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># center EEG</span>

    <span class="n">eeg_f</span><span class="p">,</span> <span class="n">eeg_pxx</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">periodogram</span><span class="p">(</span><span class="n">EEG</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">nfft</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">eeg_Pxx</span>        <span class="o">=</span> <span class="n">eeg_pxx</span><span class="o">.</span><span class="n">T</span>
    <span class="n">eeg_peak_freq</span>  <span class="o">=</span> <span class="n">eeg_f</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">eeg_pxx</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>

    <span class="c1"># get PSP FCs</span>
    <span class="n">psp_FC</span> <span class="o">=</span> <span class="n">calc_FC_PLV</span><span class="p">(</span><span class="n">PSP</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
    <span class="n">eeg_FC</span> <span class="o">=</span> <span class="n">calc_FC_PLV</span><span class="p">(</span><span class="n">EEG</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">save_timeseries_to_file</span> <span class="p">:</span>
        <span class="c1"># save results</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">save_path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">save_path</span><span class="p">)</span>

        <span class="n">file_name</span><span class="o">=</span><span class="n">save_path</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">DX</span><span class="o">+</span><span class="s2">&quot;_gc_&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">global_coupling</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;.mat&quot;</span>
        <span class="n">sio</span><span class="o">.</span><span class="n">savemat</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="n">mdict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;PSP&quot;</span><span class="p">:</span><span class="n">PSP</span><span class="p">,</span> <span class="s2">&quot;psp_baseline&quot;</span><span class="p">:</span><span class="n">psp_baseline</span><span class="p">,</span> <span class="s2">&quot;psp_peak_freq&quot;</span><span class="p">:</span><span class="n">psp_peak_freq</span><span class="p">,</span> <span class="s2">&quot;eeg_peak_freq&quot;</span><span class="p">:</span><span class="n">eeg_peak_freq</span><span class="p">,</span> <span class="s2">&quot;EEG&quot;</span><span class="p">:</span><span class="n">EEG</span><span class="p">,</span> <span class="s2">&quot;psp_FC&quot;</span><span class="p">:</span><span class="n">psp_FC</span><span class="p">,</span> <span class="s2">&quot;eeg_FC&quot;</span><span class="p">:</span><span class="n">eeg_FC</span><span class="p">})</span>


    <span class="k">return</span> <span class="p">(</span><span class="n">global_coupling</span><span class="p">,</span><span class="n">psp_baseline</span><span class="p">,</span> <span class="n">psp_peak_freq</span><span class="p">,</span> <span class="n">eeg_peak_freq</span><span class="p">,</span> <span class="n">PSP</span><span class="p">,</span> <span class="n">EEG</span><span class="p">,</span> <span class="n">psp_FC</span><span class="p">,</span> <span class="n">eeg_FC</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Run simulation</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#suppressing TVB-related notifications during multiprocessing</span>
<span class="kn">import</span> <span class="nn">warnings</span><span class="p">;</span> <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define global coupling range to explore in simulation</span>
<span class="c1"># in the original study a range from 0 to 600 with steps of 3 was explored</span>
<span class="c1"># NOTE: Too many steps will take very long time when running the script on a local computer</span>
<span class="c1"># Default values will take about 5-10mins on a standard computer</span>

<span class="n">gc_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>


<span class="c1"># run simulation in parallel - be sure that your machine has enough cores</span>
<span class="n">n_cores</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># specify number of cores which should be used in parallel</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="n">n_cores</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">run_sim</span><span class="p">,</span> <span class="n">gc_range</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-07-19 15:53:34,502 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
2023-07-19 15:53:34,496 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
2023-07-19 15:53:34,507 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
2023-07-19 15:53:34,513 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
2023-07-19 16:00:32,285 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
2023-07-19 16:00:33,190 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
</pre></div>
</div>
</div>
</div>
<p><strong>Display Results</strong></p>
<p>Here, we define several analyses of the raw neural signal and the consecutive EEG to prepare the data for visualization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">histoplots</span><span class="p">():</span>
    <span class="c1"># concatenate the output from the parallel loop</span>
    <span class="n">psp_baseline</span>  <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">psp_peak_freq</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">eeg_peak_freq</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">PSP</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">gc_range</span><span class="p">),</span><span class="mi">400</span><span class="p">,</span> <span class="mi">379</span><span class="p">))</span>
    <span class="n">EEG</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">gc_range</span><span class="p">),</span><span class="mi">400</span><span class="p">,</span> <span class="mi">64</span><span class="p">))</span>
    <span class="n">psp_FC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">gc_range</span><span class="p">),</span><span class="mi">379</span><span class="p">,</span> <span class="mi">379</span><span class="p">))</span>
    <span class="n">eeg_FC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">gc_range</span><span class="p">),</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">psp_baseline</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">psp_baseline</span><span class="p">,</span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">psp_peak_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">psp_peak_freq</span><span class="p">,</span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">eeg_peak_freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">eeg_peak_freq</span><span class="p">,</span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span>
        <span class="n">PSP</span><span class="p">[</span><span class="n">i</span><span class="p">,:,:]</span>  <span class="o">=</span> <span class="p">((</span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">]))</span>
        <span class="n">EEG</span><span class="p">[</span><span class="n">i</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="p">((</span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">]))</span>
        <span class="n">psp_FC</span><span class="p">[</span><span class="n">i</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="p">((</span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">6</span><span class="p">]))</span>
        <span class="n">eeg_FC</span><span class="p">[</span><span class="n">i</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="p">((</span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">7</span><span class="p">]))</span>

    <span class="c1">#uncomment to save the concatenated results</span>
    <span class="c1">#sio.savemat((path+&quot;/+DX+&quot;summary.mat&quot;),mdict={&quot;PSP&quot;:PSP, &quot;psp_baseline&quot;:psp_baseline, &quot;psp_peak_freq&quot;:psp_peak_freq, &quot;eeg_peak_freq&quot;:eeg_peak_freq, &quot;EEG&quot;:EEG, &quot;psp_FC&quot;:psp_FC, &quot;eeg_FC&quot;:eeg_FC})</span>

    <span class="c1"># define colormap</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">200</span><span class="p">))</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">lower</span><span class="p">))</span>
    <span class="n">tmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">26</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>

    <span class="c1"># plot results</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">x_coord</span>       <span class="o">=</span> <span class="n">gc_range</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">379</span><span class="p">)</span>
    <span class="n">x_coord_eeg</span>   <span class="o">=</span> <span class="n">gc_range</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span>

    <span class="c1"># plot psp frequency</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist2d</span><span class="p">(</span><span class="n">x_coord</span><span class="p">,</span> <span class="n">psp_peak_freq</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">gc_range</span><span class="p">),</span><span class="mi">40</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">tmap</span><span class="p">,</span>
              <span class="nb">range</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">gc_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">gc_range</span><span class="p">)],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">14</span><span class="p">]]</span> <span class="p">)</span> <span class="c1">#, vmax=100)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Number of regions&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39; Frequency in Hz&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39; global coupling &#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;LFP frequency&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;18&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">1.05</span><span class="p">)</span>


    <span class="c1"># plot psp baseline</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist2d</span><span class="p">(</span><span class="n">x_coord</span><span class="p">,</span> <span class="n">psp_baseline</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">gc_range</span><span class="p">),</span><span class="mi">40</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">tmap</span><span class="p">,</span>
              <span class="nb">range</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">gc_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">gc_range</span><span class="p">)],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">40</span><span class="p">]])</span><span class="c1">#, vmax=100)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Number of regions&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39; PSP in mV&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39; global coupling &#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;PSP baseline&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;18&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">1.05</span><span class="p">)</span>


    <span class="c1"># plot eeg frequency</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist2d</span><span class="p">(</span><span class="n">x_coord_eeg</span><span class="p">,</span> <span class="n">eeg_peak_freq</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">gc_range</span><span class="p">),</span><span class="mi">40</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">tmap</span><span class="p">,</span>
              <span class="nb">range</span><span class="o">=</span><span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">gc_range</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">gc_range</span><span class="p">)],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">14</span><span class="p">]]</span> <span class="p">)</span><span class="c1">#, vmax=100)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Number of regions&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39; Frequency in Hz&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39; global coupling &#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;EEG frequency&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;18&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">1.05</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span>

<span class="k">def</span> <span class="nf">EEGplots</span><span class="p">(</span><span class="n">G</span><span class="p">):</span>
    <span class="c1"># concatenate the output from the parallel loop</span>
    <span class="n">EEG</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">gc_range</span><span class="p">),</span><span class="mi">400</span><span class="p">,</span> <span class="mi">64</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">EEG</span><span class="p">[</span><span class="n">i</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="p">((</span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">]))</span>

    <span class="c1"># define colormap</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">200</span><span class="p">))</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">lower</span><span class="p">))</span>
    <span class="n">tmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">26</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>

    <span class="c1">#Plot results</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">EEG</span><span class="p">[</span><span class="n">i</span><span class="p">,:,:]</span> <span class="o">=</span> <span class="p">((</span><span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">]))</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span><span class="mi">4000</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">GridSpec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">EEG</span><span class="p">[</span><span class="n">i</span><span class="p">,:,:]);</span>

    <span class="k">return</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">histoplots</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1206a836e5f1da986d4c8e0e64b7c5e7a196af162c4f000eb069dbf4d406d2be.png" src="../_images/1206a836e5f1da986d4c8e0e64b7c5e7a196af162c4f000eb069dbf4d406d2be.png" />
</div>
</div>
<p>Here, you see the spectral behavior of the system across the global coupling parameter G.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">EEGplots</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1800x400 with 0 Axes&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1800x400 with 0 Axes&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1800x400 with 0 Axes&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1800x400 with 0 Axes&gt;
</pre></div>
</div>
<img alt="../_images/c9411b904cadea87eb75e4548498fdedb29c33efe96d361bfb2edc8e9875be77.png" src="../_images/c9411b904cadea87eb75e4548498fdedb29c33efe96d361bfb2edc8e9875be77.png" />
</div>
</div>
<p>A few example timseries from different areas of the abovementioned parameter space exploration are provided here. As it can be seen, the system changes between different oscillatory behaviors.</p>
<p><strong>Translate model to a linear transfer function</strong></p>
<p>Now, as a summary of the above, you can try out to simplify the simulation above by using a linear transfer function insetad of the sigmoid. We have to make sure that the linear function has high similarity to the part of the sigmid between the asymptotes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Selection of a  linear function with a similar behavior in the range of interest</span>
<span class="c1"># y(1) = 0.07</span>
<span class="c1"># y(2) = 0.02</span>
<span class="c1"># y = mx + c</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">transform_linear</span><span class="p">(</span><span class="n">abeta_burden</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.095</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">3.5</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">transform_linear</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="o">-</span><span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.095</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">transform_sigmoid</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">y_max</span><span class="p">,</span> <span class="n">y_min</span><span class="p">,</span> <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Linear vs. sigmoidal transfer function&quot;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;18&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mf">1.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1f567612c330359366149a869ff19cc68091eadf2592171431575b5898c33d74.png" src="../_images/1f567612c330359366149a869ff19cc68091eadf2592171431575b5898c33d74.png" />
</div>
</div>
<p><strong>Summary</strong></p>
<p>configure a simulation by using regional information
In the following, we will provide you similar code as in the examples above to use for your own cause-and-effect models</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">INPUT</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">379</span><span class="p">,)</span>
<span class="n">y_min</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">y_max</span>  <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">x_1</span> <span class="o">=</span> <span class="mf">1.4</span>
<span class="n">x_2</span> <span class="o">=</span> <span class="mf">2.65</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">transfer</span> <span class="o">=</span> <span class="n">transform_sigmoid</span><span class="p">(</span><span class="n">INPUT</span><span class="p">,</span> <span class="n">y_max</span><span class="p">,</span> <span class="n">y_min</span><span class="p">,</span> <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span>
<span class="c1">#Change to linear, reciprocal, logarithmic</span>

<span class="c1">#Select white matter connectivity</span>
<span class="n">white_matter</span> <span class="o">=</span> <span class="n">connectivity</span><span class="o">.</span><span class="n">Connectivity</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;/content/03_Clinical/Stefanovski/Connectome/SC.zip&#39;</span><span class="p">)</span>
<span class="n">white_matter</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>

<span class="c1">#Define monitor</span>
<span class="n">subsample</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">monitors</span><span class="o">.</span><span class="n">SubSample</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">subsample</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>

<span class="c1">#Saving options</span>
<span class="n">save_timeseries_to_file</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">save_path</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

<span class="c1">#Intial conditions</span>
<span class="n">init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4000</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">SCnorm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">);</span>

<span class="c1">#Neural Mass model selection and integration of information array to one variable</span>
<span class="n">jrm</span> <span class="o">=</span> <span class="n">ExtendedJansenRit</span><span class="p">(</span><span class="n">v0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">p_max</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">p_min</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span>
                       <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">transfer</span><span class="p">))</span>

<span class="c1">#Simulator configuration</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span>  <span class="n">connectivity</span><span class="o">=</span><span class="n">white_matter</span><span class="p">,</span>
                            <span class="n">model</span><span class="o">=</span><span class="n">jrm</span><span class="p">,</span>
                            <span class="n">coupling</span><span class="o">=</span><span class="n">coupling</span><span class="o">.</span><span class="n">SigmoidalJansenRit</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)),</span>
                            <span class="n">integrator</span><span class="o">=</span><span class="n">integrators</span><span class="o">.</span><span class="n">HeunDeterministic</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
                            <span class="n">conduction_speed</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                            <span class="n">monitors</span><span class="o">=</span><span class="p">[</span><span class="n">subsample</span><span class="p">],</span>
                            <span class="n">initial_conditions</span> <span class="o">=</span> <span class="n">init</span><span class="p">,</span>
                            <span class="n">simulation_length</span><span class="o">=</span><span class="mf">4000.0</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">configure</span><span class="p">();</span>

<span class="c1">#Define range of G</span>
<span class="n">gc_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>

<span class="c1">#Choose number of cores</span>
<span class="n">n_cores</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">processes</span><span class="o">=</span><span class="n">n_cores</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">run_sim</span><span class="p">,</span> <span class="n">gc_range</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-07-19 16:03:53,619 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
2023-07-19 16:03:53,629 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
2023-07-19 16:03:53,622 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
2023-07-19 16:03:53,631 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
2023-07-19 16:10:19,420 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
</pre></div>
</div>
</div>
</div>
<div class="section" id="whole-brain-modeling-for-epilepsy-diagnosis">
<h2><strong>Whole brain modeling for epilepsy diagnosis</strong><a class="headerlink" href="#whole-brain-modeling-for-epilepsy-diagnosis" title="Permalink to this heading">#</a></h2>
<p>In this part we will explore how the virtual epileptic patient (VEP), a workflow that uses personalized brain models and machine learning methods, can be useful to  estimates of epileptogenic zone networks (EZNs) and to aid surgical strategies to treat drug-resistant focal epilepsy as demonstrated in <a class="reference external" href="https://www.science.org/doi/abs/10.1126/scitranslmed.abp8982?utm_campaign=SciMag&amp;utm_source=Twitter&amp;utm_medium=ownedSocial&amp;intcmp=trendmd-stm">Wang et al. 2023</a> &amp; <a class="reference external" href="https://academic.oup.com/brain/article/137/8/2210/2847958">Jirsa et al.2014</a></p>
<p><strong>A. Exploring the Epileptor model</strong></p>
<p><img alt="alt" src="https://www.medrxiv.org/content/medrxiv/early/2022/01/21/2022.01.19.22269404/F1.large.jpg?width=800&amp;height=600&amp;carousel=1" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="k">def</span> <span class="nf">seeg_ch_name_split</span><span class="p">(</span><span class="n">nm</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Split an sEEG channel name into its electrode name and index</span>
<span class="sd">    &gt;&gt;&gt; seeg_ch_name_split(&#39;GPH10&#39;)</span>
<span class="sd">    (&#39;GPH&#39;, 10)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">elec</span><span class="p">,</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([A-Za-z&#39;]+)(\d+)&quot;</span><span class="p">,</span> <span class="n">nm</span><span class="p">)</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">elec</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">bipolarize_gain_minus</span><span class="p">(</span><span class="n">gain</span><span class="p">,</span> <span class="n">seeg_xyz</span><span class="p">,</span> <span class="n">seeg_xyz_names</span><span class="p">,</span><span class="n">is_minus</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="c1">#from icdc import seeg_ch_name_split</span>
    <span class="n">split_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">seeg_ch_name_split</span><span class="p">(</span><span class="n">el</span><span class="p">)</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">seeg_xyz_names</span><span class="p">]</span>
    <span class="n">bip_gain_rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">bip_xyz</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">bip_names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">split_names</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">split_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">next_name</span><span class="p">,</span> <span class="n">next_idx</span> <span class="o">=</span> <span class="n">split_names</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">next_name</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">is_minus</span><span class="p">:</span>
                    <span class="n">bip_gain_rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gain</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">gain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bip_gain_rows</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">gain</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">gain</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>
                <span class="n">bip_xyz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[(</span><span class="n">p</span> <span class="o">+</span> <span class="n">q</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">seeg_xyz</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">seeg_xyz</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])]</span>
                <span class="p">)</span>
                <span class="n">bip_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s%d</span><span class="s2">-</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">next_idx</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span>
    <span class="c1"># abs val, envelope/power always postive</span>
    <span class="n">bip_gain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bip_gain_rows</span><span class="p">))</span>
    <span class="n">bip_xyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bip_xyz</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">bip_gain</span><span class="p">,</span> <span class="n">bip_xyz</span><span class="p">,</span> <span class="n">bip_names</span>

<span class="c1"># Plot time series</span>
<span class="k">def</span> <span class="nf">plot_ts</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1"># Normalize the time series to have nice plots</span>
    <span class="n">y</span> <span class="o">/=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:],</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x1&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:],</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">4.5</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;y1&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:],</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x2&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:],</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;C7&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;y2&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:],</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Epileptors time series&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [ms]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="c1">#yticks(np.arange(len(labels)), labels, fontsize=15)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">plot_ts_3d</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1"># Normalize the time series to have nice plots</span>
    <span class="n">y</span> <span class="o">/=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x2-10*x1&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y2&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Epileptor time series in 3D&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># @title Functions taken from Wang et al. 2023 Science Translational Medicine</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## First step : importing libraries</span>
<span class="kn">from</span> <span class="nn">tvb.simulator.lab</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">plc</span>
<span class="kn">import</span> <span class="nn">time</span> <span class="k">as</span> <span class="nn">tm</span>

<span class="c1"># @title Importage</span>
</pre></div>
</div>
</div>
</div>
<p>The epilesy can be modelled in TVB using the epileptor model by <a class="reference external" href="https://academic.oup.com/brain/article/137/8/2210/2847958">Jirsa et al.2014</a></p>
<p>The two dynamics that the epileptor model can represent are: <br/></p>
<ol class="arabic simple">
<li><p><strong>A saddle-node bifurcation:</strong> a type of critical point or bifurcation in dynamical systems theory. It occurs when a stable equilibrium (or fixed point) and an unstable equilibrium collide and annihilate each other. <br/></p></li>
<li><p><strong>A saddle homoclinic bifurcation:</strong> a type of bifurcation that occurs in dynamical systems when a saddle point of the system collides with its own unstable manifold (homoclinic orbit).<br/></p></li>
</ol>
<p>To understand these bifurcations better, let’s break it down step by step:</p>
<ul class="simple">
<li><p>Saddle Point: In a dynamical system, a saddle point is an equilibrium point that has a stable manifold and an unstable manifold. The stable manifold contains trajectories that converge towards the saddle point in the future, while the unstable manifold contains trajectories that diverge from the saddle point in the future.</p></li>
<li><p>Homoclinic Orbit: A homoclinic orbit is a trajectory that connects the saddle point to itself, both forwards and backwards in time.</p></li>
<li><p>Homoclinic Bifurcation: During a saddle homoclinic bifurcation, as a parameter in the dynamical system is varied, the stable and unstable manifolds of the saddle point gradually change. When a critical value of the parameter is reached, the stable and unstable manifolds intersect, and the homoclinic orbit is born. This occurs due to the saddle point and its homoclinic orbit coming together in phase space.</p></li>
</ul>
<p>The epileptor model is a phenomenological model composed by 5 states variables.<br/>
<br/>
\begin{equation}
\dot{x_{1}} = y_{1} - f_{1}(x_{1},x_{2}) -z + I_{ext1} \
\dot{y_{1}} = c-dx^2_{1} -y_{1} \
\dot{x_{2}} = -y_{2} + x_{2} - x^3_{2} + I_{ext2} + 0.002g -0.3(z-3.5)\
\dot{y_{2}} = \frac{1}{\tau(y_{2} + f_{2}x_{2})} \
\dot{z} = r(4(x_{1} - x_{0})- z) +  f_{3}(z) + K\sum_{j=1}^N C_{ij} (x^j_{1} - x^i_{1}) \ \
\dot{g} = -0.01(g-0.1 x_{1}) \
\end{equation}
<br/></p>
<p>The <span class="math notranslate nohighlight">\(x_{1}\)</span> population displays seizure activity characterized by low voltage fast discharges.</p>
<p>The <span class="math notranslate nohighlight">\(x_{2}\)</span> population reproduce the presence of interictal spike and wave events which is common in epilepsy.</p>
<p>In epilepsy, there are two states: the ictal state (representing the actual seizure state) and the interictal state, during which the patient is in a “normal state.” So in our system the patient must be able to switch between one state to the other. For accounting this transition between these states, we rely on the <span class="math notranslate nohighlight">\(z\)</span> variable, which facilitates the switch from the interictal state to the ictal state.</p>
<p>One important variable in the model is the <span class="math notranslate nohighlight">\(x_{0}\)</span> which determines if our system is going to trigger a seizure or if it is in resting-state.
When the variable remains below a specific threshold, the system exists in a fixed-point state <em>(healthy state)</em>. However, once the threshold is surpassed, it triggers a seizure <em>(epileptogenicity state)</em>.</p>
<p>The output of the epileptor is a <span class="math notranslate nohighlight">\(x_{2} - x_{1}\)</span> which means that is the output of the two part of the epileptor: low voltage fast discharges and the spike and wave.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data</span>
<span class="n">data_path</span> <span class="o">=</span> <span class="s1">&#39;/content/03_Clinical/Dollomaja&#39;</span>

<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">data_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="generate-synthetic-data">
<h3><strong>Generate Synthetic Data</strong><a class="headerlink" href="#generate-synthetic-data" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Nt</span><span class="p">,</span> <span class="n">Tend</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">1e-1</span>
<span class="n">dt</span><span class="o">=</span><span class="n">Tend</span><span class="o">/</span><span class="n">Nt</span>
<span class="n">t0</span><span class="o">=</span><span class="mf">0.0</span>
<span class="n">Ts</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="n">Tend</span><span class="o">+</span><span class="n">dt</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>

<span class="n">tau0</span><span class="o">=</span><span class="mf">10.</span>
<span class="n">I1</span><span class="o">=</span><span class="mf">3.1</span>

<span class="n">x_0</span> <span class="o">=-</span><span class="mf">1.5</span>

<span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nt</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nt</span><span class="p">)</span>
<span class="n">xs</span><span class="p">,</span> <span class="n">zs</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nt</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nt</span><span class="p">)</span>

<span class="n">x_init</span><span class="p">,</span> <span class="n">z_init</span><span class="o">=-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">3.5</span>

<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">x_init</span><span class="p">,</span> <span class="n">z_init</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nt</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">dx</span> <span class="o">=</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">z</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">I1</span>
    <span class="n">dz</span> <span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">tau0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">-</span><span class="n">x_0</span><span class="p">)</span> <span class="o">-</span> <span class="n">z</span><span class="p">[</span><span class="n">t</span><span class="p">])</span>
    <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span> <span class="o">*</span><span class="n">sigma</span> <span class="o">*</span> <span class="n">randn</span><span class="p">())</span>
    <span class="n">z</span><span class="p">[</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dz</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span> <span class="o">*</span><span class="n">sigma</span> <span class="o">*</span> <span class="n">randn</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xs</span><span class="p">,</span><span class="n">zs</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">sigma</span><span class="o">*</span><span class="n">randn</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">array</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">+</span><span class="n">sigma</span><span class="o">*</span><span class="n">randn</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">obs</span><span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">xs</span><span class="p">,</span> <span class="n">zs</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">dt</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[:</span><span class="n">xs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,(</span><span class="n">obs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span> <span class="p">,</span> <span class="s1">&#39;--b.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$x(t)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">obs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;--r.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$z(t)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">);</span> <span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/46dc76bf0563cffc627f55a3a15f08a83a794b64d0ef902b41e982c57fe59e66.png" src="../_images/46dc76bf0563cffc627f55a3a15f08a83a794b64d0ef902b41e982c57fe59e66.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Epileptor2D</span><span class="p">(</span><span class="n">Nt</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">f_decim</span><span class="p">,</span> <span class="n">x_init</span><span class="p">,</span> <span class="n">z_init</span><span class="p">,</span> <span class="n">tau0</span><span class="p">,</span> <span class="n">eta_true</span><span class="p">):</span>
    <span class="n">xs</span><span class="p">,</span> <span class="n">zs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x_init</span><span class="p">],</span> <span class="p">[</span><span class="n">z_init</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nt</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">xs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">zs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dx</span> <span class="o">=</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">z</span> <span class="o">+</span> <span class="n">I1</span>
        <span class="n">dz</span> <span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">tau0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">eta_true</span><span class="p">)</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span>
        <span class="n">xs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dx</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">randn</span><span class="p">())</span>
        <span class="n">zs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">dz</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">randn</span><span class="p">())</span>

    <span class="n">xs</span><span class="p">,</span><span class="n">zs</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="n">array</span><span class="p">(</span><span class="n">zs</span><span class="p">)</span>

    <span class="n">xs</span><span class="p">,</span><span class="n">zs</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="o">+</span><span class="n">sigma</span><span class="o">*</span><span class="n">randn</span><span class="p">(</span><span class="n">xs</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">array</span><span class="p">(</span><span class="n">zs</span><span class="p">)</span><span class="o">+</span><span class="n">sigma</span><span class="o">*</span><span class="n">randn</span><span class="p">(</span><span class="n">zs</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

    <span class="n">obs</span><span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">xs</span><span class="p">,</span> <span class="n">zs</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">dt</span><span class="o">*</span><span class="n">r_</span><span class="p">[:</span><span class="n">xs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="n">obs_decim</span><span class="p">,</span> <span class="n">ts_decim</span><span class="o">=</span> <span class="n">obs</span><span class="p">[::</span><span class="n">f_decim</span><span class="p">],</span> <span class="n">ts</span><span class="p">[::</span><span class="n">f_decim</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">ts_decim</span><span class="p">,</span> <span class="n">obs_decim</span>

<span class="k">def</span> <span class="nf">nullclines</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span> <span class="n">tau0</span><span class="p">):</span>
    <span class="n">dX</span> <span class="o">=</span>  <span class="mf">1.0</span> <span class="o">-</span> <span class="n">X</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">Y</span> <span class="o">+</span> <span class="n">I1</span>
    <span class="n">dY</span> <span class="o">=</span>  <span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">tau0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">X</span><span class="o">-</span><span class="n">x_0</span><span class="p">)</span> <span class="o">-</span> <span class="n">Y</span><span class="p">)</span>
    <span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">dX</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">dY</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">root_fuc</span><span class="p">(</span><span class="n">roots</span><span class="p">,</span> <span class="n">x_0</span><span class="p">,</span> <span class="n">tau0</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">F</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">roots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">roots</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">z</span> <span class="o">+</span> <span class="n">I1</span>
    <span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="o">/</span><span class="n">tau0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x_0</span><span class="p">)</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">F</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_decim</span><span class="o">=</span><span class="mi">1</span>
<span class="n">obs_decim</span><span class="p">,</span> <span class="n">ts_decim</span><span class="o">=</span> <span class="n">obs</span><span class="p">[::</span><span class="n">f_decim</span><span class="p">],</span> <span class="n">ts</span><span class="p">[::</span><span class="n">f_decim</span><span class="p">]</span>
<span class="n">Ts_decim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span><span class="n">Tend</span><span class="o">+</span><span class="n">dt</span><span class="p">,</span><span class="n">dt</span><span class="o">*</span><span class="n">f_decim</span><span class="p">)</span>

<span class="n">rGuess</span><span class="o">=</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span><span class="mf">3.</span><span class="p">]])</span>
<span class="n">true_roots</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">root_fuc</span><span class="p">,</span><span class="n">rGuess</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">x_0</span><span class="p">,</span> <span class="n">tau0</span><span class="p">))</span>

<span class="n">X</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mf">5.0</span><span class="p">:</span><span class="mf">5.0</span><span class="p">:</span><span class="mi">100</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">:</span><span class="mf">10.0</span><span class="p">:</span><span class="mi">100</span><span class="n">j</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obs_decim</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">obs_decim</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">nullclines</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span>  <span class="n">x_0</span><span class="p">,</span> <span class="n">tau0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">true_roots</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">true_roots</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;True phase-plane&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/13cce3d90b7c08037af20d326947ecdda446db64ab322301f48df43ba6c6f3f1.png" src="../_images/13cce3d90b7c08037af20d326947ecdda446db64ab322301f48df43ba6c6f3f1.png" />
</div>
</div>
<p>Different Value of <span class="math notranslate nohighlight">\(x_{0}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rGuess</span><span class="o">=</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span><span class="mf">3.</span><span class="p">]])</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="n">mgrid</span><span class="p">[</span><span class="o">-</span><span class="mf">5.0</span><span class="p">:</span><span class="mf">5.0</span><span class="p">:</span><span class="mi">100</span><span class="n">j</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">:</span><span class="mf">10.0</span><span class="p">:</span><span class="mi">100</span><span class="n">j</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">x_0_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="o">-</span><span class="mf">.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.6</span><span class="p">]):</span>
        <span class="n">ts_decim</span><span class="p">,</span> <span class="n">obs_decim</span><span class="o">=</span><span class="n">Epileptor2D</span><span class="p">(</span><span class="n">Nt</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">f_decim</span><span class="p">,</span> <span class="n">x_init</span><span class="p">,</span> <span class="n">z_init</span><span class="p">,</span> <span class="n">tau0</span><span class="p">,</span> <span class="n">x_0_val</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">ts_decim</span><span class="p">,</span> <span class="n">obs_decim</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;--b.&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x(t)$&#39;</span><span class="p">);</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;$x_</span><span class="si">{0}</span><span class="s1">$= </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">x_0_val</span>)
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">idx</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">ts_decim</span><span class="p">,</span> <span class="n">obs_decim</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;--r&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z(t)$&#39;</span><span class="p">);</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;$x_</span><span class="si">{0}</span><span class="s1">$= </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">x_0_val</span>)
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">idx</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">obs_decim</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">obs_decim</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
        <span class="n">true_roots</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">root_fuc</span><span class="p">,</span><span class="n">rGuess</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">x_0_val</span><span class="p">,</span> <span class="n">tau0</span><span class="p">))</span>
        <span class="n">nullclines</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span>  <span class="n">x_0_val</span><span class="p">,</span> <span class="n">tau0</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">true_roots</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">true_roots</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x(t)$&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$z(t)$&#39;</span><span class="p">);</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;$x_</span><span class="si">{0}</span><span class="s1">$= </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">x_0_val</span>)

        <span class="k">if</span> <span class="o">-</span><span class="mf">2.05</span><span class="o">&lt;</span><span class="n">x_0_val</span><span class="o">&lt;-</span><span class="mf">1.05</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">5.25</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$EZ$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="o">-</span><span class="mf">2.5</span><span class="o">&lt;=</span><span class="n">x_0_val</span><span class="o">&lt;=-</span><span class="mf">2.05</span> <span class="ow">or</span> <span class="o">-</span><span class="mf">1.05</span><span class="o">&lt;=</span><span class="n">x_0_val</span><span class="o">&lt;=-</span><span class="mf">.5</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">5.25</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$PZ$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">5.25</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$HZ$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e2a0437a2692538520a3d1cb43c0b0d28800ed37823ad003773751eba530c053.png" src="../_images/e2a0437a2692538520a3d1cb43c0b0d28800ed37823ad003773751eba530c053.png" />
</div>
</div>
<p><strong>Implement the Epileptor in TVB</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">implement_sim_and_run</span><span class="p">(</span><span class="n">x0</span><span class="o">=-</span><span class="mf">1.6</span><span class="p">,</span> <span class="n">simulation_length</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
    <span class="n">epileptormod</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Epileptor</span><span class="p">()</span>
    <span class="n">epileptormod</span><span class="o">.</span><span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">x0</span>
    <span class="n">epileptormod</span><span class="o">.</span><span class="n">variables_of_interest</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;y1&#39;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;y2&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]</span>

    <span class="n">n</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">conn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[:</span><span class="n">n</span> <span class="o">*</span> <span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="n">init_cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.98742113e+00</span> <span class="p">,</span> <span class="o">-</span><span class="mf">1.87492138e+01</span><span class="p">,</span> <span class="mf">4.0529597e+00</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.05214059e+00</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.95543740e-20</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.98742113e-01</span><span class="p">])</span>
    <span class="n">init_cond_reshaped</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">init_cond</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">init_cond</span><span class="p">),</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>


    <span class="n">sim</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">epileptormod</span><span class="p">,</span>
                              <span class="n">initial_conditions</span><span class="o">=</span><span class="n">init_cond_reshaped</span><span class="p">,</span>
                              <span class="n">connectivity</span><span class="o">=</span><span class="n">connectivity</span><span class="o">.</span><span class="n">Connectivity</span><span class="p">(</span><span class="n">region_labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">]),</span><span class="n">weights</span><span class="o">=</span><span class="n">conn</span><span class="p">,</span>
                                                                     <span class="n">tract_lengths</span><span class="o">=</span><span class="n">dist</span><span class="p">,</span> <span class="n">speed</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">]),</span>
                                                                     <span class="n">centres</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">])),</span>
                              <span class="n">coupling</span><span class="o">=</span><span class="n">coupling</span><span class="o">.</span><span class="n">Difference</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.2</span><span class="p">])),</span>
                              <span class="n">integrator</span><span class="o">=</span><span class="n">integrators</span><span class="o">.</span><span class="n">HeunDeterministic</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.05</span><span class="p">),</span>
                              <span class="n">monitors</span><span class="o">=</span><span class="p">(</span><span class="n">monitors</span><span class="o">.</span><span class="n">TemporalAverage</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="mf">1.</span><span class="p">),))</span>
    <span class="n">sim</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting simulation...&quot;</span><span class="p">)</span>
    <span class="n">tic</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">simulation_length</span><span class="o">=</span><span class="n">simulation_length</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Finished simulation.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;execute for &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">tic</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">t</span><span class="p">,</span><span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">implement_sim_and_run</span><span class="p">()</span>
<span class="n">plot_ts</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Starting simulation...
2023-07-21 19:17:54,110 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
Finished simulation.
execute for 48.73790979385376
</pre></div>
</div>
<img alt="../_images/090af17af2e9ee434604f301a99495e3766691d0911fede86f69ace88aed180a.png" src="../_images/090af17af2e9ee434604f301a99495e3766691d0911fede86f69ace88aed180a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_ts_3d</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/279d876dd386466b77d9813bf3635d17636fc7396f77195f9e5cbc99763da2c4.png" src="../_images/279d876dd386466b77d9813bf3635d17636fc7396f77195f9e5cbc99763da2c4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simulation_length</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">t_vec</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">y_vec</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x0</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">2.8</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
    <span class="n">t</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">implement_sim_and_run</span><span class="p">(</span><span class="o">-</span><span class="n">x0</span><span class="p">,</span> <span class="n">simulation_length</span><span class="p">)</span>
    <span class="n">t_vec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">y_vec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.8
Starting simulation...
2023-07-21 19:18:43,595 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
Finished simulation.
execute for 35.018035650253296
2.1
Starting simulation...
2023-07-21 19:19:18,618 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
Finished simulation.
execute for 39.78434896469116
1.9
Starting simulation...
2023-07-21 19:19:58,411 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
Finished simulation.
execute for 35.29886031150818
1.5
Starting simulation...
2023-07-21 19:20:33,716 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
Finished simulation.
execute for 40.14355731010437
1
Starting simulation...
2023-07-21 19:21:13,866 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
Finished simulation.
execute for 38.02725911140442
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mf">2.8</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]):</span>
    <span class="n">tavg</span> <span class="o">=</span> <span class="n">y_vec</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">srcSig</span> <span class="o">=</span> <span class="n">tavg</span><span class="p">[:,</span><span class="mi">2</span><span class="p">,:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">tavg</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Normalize the time series to have nice plots</span>
    <span class="n">srcSig</span> <span class="o">/=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">srcSig</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">srcSig</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">srcSig_normal</span> <span class="o">=</span> <span class="n">srcSig</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">srcSig</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [ms]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;x2-x1&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">[:],</span><span class="n">srcSig_normal</span><span class="p">[:]</span> <span class="o">+</span> <span class="n">idx</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x0  = -&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Epileptors time series&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="c1"># plt.ylim([-1,len(roi)+0.5])</span>
    <span class="c1"># plt.xlim([t[0],t[-1]])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="c1"># plt.title(f&#39;{pid}&#39;)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ab33643812ff50c9a3b6e86c90a4cc761828f9d739179103bd3f493c01609c25.png" src="../_images/ab33643812ff50c9a3b6e86c90a4cc761828f9d739179103bd3f493c01609c25.png" />
</div>
</div>
<p><strong>B. Region based simulation of a temporal lobe seizure</strong></p>
<p><em><strong>1. Initialize connectivities, model, coupling, integrators and monitors</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Connectivity</span>
<span class="n">con</span> <span class="o">=</span> <span class="n">connectivity</span><span class="o">.</span><span class="n">Connectivity</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">data_path</span><span class="si">}</span><span class="s1">/connectivity.vep.zip&#39;</span><span class="p">)</span>
<span class="n">con</span><span class="o">.</span><span class="n">tract_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">con</span><span class="o">.</span><span class="n">tract_lengths</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>             <span class="c1"># no time-delays</span>
<span class="n">con</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">diag_indices</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">weights</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># con.weights = np.log(con.weights+1)</span>
<span class="n">con</span><span class="o">.</span><span class="n">weights</span> <span class="o">/=</span> <span class="n">con</span><span class="o">.</span><span class="n">weights</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">con</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
<span class="n">nb_regions</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">number_of_regions</span>
<span class="n">con</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-07-21 19:21:52,756 - WARNING - tvb.basic.readers - File &#39;hemispheres&#39; not found in ZIP.
</pre></div>
</div>
<div class="output text_html"><table>
<thead><h3>Connectivity</h3></thead>
<tbody>

<tr><th></th><th style="text-align:left;width:80%">value</th></tr>
<tr><td>Number of connections</td><td style="text-align:left;"><pre>23206</pre></td></tr>
<tr><td>Number of regions</td><td style="text-align:left;"><pre>162</pre></td></tr>
<tr><td>Undirected</td><td style="text-align:left;"><pre>True</pre></td></tr>
<tr><td>areas</td><td style="text-align:left;"><pre> [min, median, max] = [272.05, 1274.95, 13401.9] dtype = float64 shape = (162,)</pre></td></tr>
<tr><td>tract_lengths</td><td style="text-align:left;"><pre> [min, median, max] = [0, 0, 0] dtype = float64 shape = (162, 162)</pre></td></tr>
<tr><td>tract_lengths (connections)</td><td style="text-align:left;"><pre> [min, median, max] = [0, 0, 0] dtype = float64 shape = (23206,)</pre></td></tr>
<tr><td>tract_lengths-non-zero is empty</td><td style="text-align:left;"><pre>True</pre></td></tr>
<tr><td>weights</td><td style="text-align:left;"><pre> [min, median, max] = [0, 0.000225517, 1] dtype = float64 shape = (162, 162)</pre></td></tr>
<tr><td>weights-non-zero</td><td style="text-align:left;"><pre> [min, median, max] = [1.18693e-05, 0.00034421, 1] dtype = float64 shape = (23206,)</pre></td></tr>
</tbody></table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SC</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">weights</span>
<span class="n">roi</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">region_labels</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">SC</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">plc</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">SC</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Normalized SC (log scale)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">roi</span><span class="p">)],</span> <span class="n">roi</span><span class="p">,</span> <span class="n">rotation</span> <span class="o">=</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">roi</span><span class="p">)],</span> <span class="n">roi</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7c34114317997cd0c0e9c17ad238099ecd69d5ef282736fde561059adf9403af.png" src="../_images/7c34114317997cd0c0e9c17ad238099ecd69d5ef282736fde561059adf9403af.png" />
</div>
</div>
<p>Now that we have our connectivity we can introduce some anomalities and heteroteneity to our network for:</p>
<ul class="simple">
<li><p><strong>Epileptogenic Zone (EZ):</strong> the hypothetical area in the brain responsible for the origin and early organization of the epileptic activity</p></li>
<li><p><strong>The Propagation Zone (PZ):</strong> comprises areas that are recruited during the seizure evolution, but are by themselves not epileptogenic.<br/>
<br/></p></li>
</ul>
<p><img alt="alt" src="https://ars.els-cdn.com/content/image/1-s2.0-S1053811916300891-gr1.jpg" /></p>
<br/>
<p>For further details on how to estimate this heterogeity please see <a class="reference external" href="https://epjnonlinearbiomedphys.springeropen.com/articles/10.1140/epjnbp11">Bartolomei et al., 2013</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0ez</span><span class="o">=-</span><span class="mf">1.2</span>
<span class="n">x0pz</span><span class="o">=-</span><span class="mf">1.6</span>
<span class="n">x0num</span><span class="o">=-</span><span class="mf">2.5</span>

<span class="c1">#ezind = 0</span>
<span class="n">ROI</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">]</span>
<span class="n">EZ</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Right-Hippocampus-anterior&#39;</span><span class="p">]</span>
<span class="n">PZ</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Right-Hippocampus-posterior&#39;</span><span class="p">,</span> <span class="s1">&#39;Right-Rhinal-cortex&#39;</span><span class="p">,</span> <span class="s1">&#39;Right-T3-anterior&#39;</span><span class="p">,</span> <span class="s1">&#39;Left-Hippocampus-anterior&#39;</span><span class="p">,</span> <span class="s1">&#39;Left-Temporal-pole&#39;</span><span class="p">]</span>
<span class="n">idx_EZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">roi</span> <span class="o">==</span> <span class="n">EZ</span><span class="p">)</span>
<span class="n">idx_PZ</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">roi</span> <span class="o">==</span> <span class="n">pz</span><span class="p">)</span> <span class="k">for</span> <span class="n">pz</span> <span class="ow">in</span> <span class="n">PZ</span><span class="p">]</span>

<span class="n">epileptors</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Epileptor</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.00035</span><span class="p">]))</span>
<span class="n">epileptors</span><span class="o">.</span><span class="n">x0</span> <span class="o">=</span> <span class="n">x0num</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nb_regions</span><span class="p">)</span>
<span class="n">epileptors</span><span class="o">.</span><span class="n">x0</span><span class="p">[</span><span class="n">idx_EZ</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0ez</span>
<span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">idx_PZ</span><span class="p">:</span>
    <span class="n">epileptors</span><span class="o">.</span><span class="n">x0</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0pz</span>
    <span class="n">x0pz</span> <span class="o">-=</span> <span class="mf">0.1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Coupling</span>
<span class="n">coupl</span> <span class="o">=</span> <span class="n">coupling</span><span class="o">.</span><span class="n">Difference</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.2</span><span class="p">]))</span>

<span class="c1"># Integrators</span>
<span class="n">heunint</span> <span class="o">=</span> <span class="n">integrators</span><span class="o">.</span><span class="n">HeunDeterministic</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="c1"># Monitors</span>
<span class="n">mons</span> <span class="o">=</span> <span class="p">[</span><span class="n">monitors</span><span class="o">.</span><span class="n">TemporalAverage</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="mi">3</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p><em><strong>2. Set up simulator, run and visualize results</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initial conditions</span>
<span class="n">init_cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.98742113e+00</span> <span class="p">,</span> <span class="o">-</span><span class="mf">1.87492138e+01</span><span class="p">,</span> <span class="mf">4.0529597e+00</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.05214059e+00</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.95543740e-20</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.98742113e-01</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">init_cond</span><span class="p">)</span>
<span class="n">init_cond_reshaped</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">init_cond</span><span class="p">,</span> <span class="n">nb_regions</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">init_cond</span><span class="p">),</span> <span class="n">nb_regions</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Simulator</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">epileptors</span><span class="p">,</span>
                          <span class="n">initial_conditions</span><span class="o">=</span><span class="n">init_cond_reshaped</span><span class="p">,</span>
                          <span class="n">connectivity</span><span class="o">=</span><span class="n">con</span><span class="p">,</span>
                          <span class="n">coupling</span><span class="o">=</span><span class="n">coupl</span><span class="p">,</span>
                          <span class="n">integrator</span><span class="o">=</span><span class="n">heunint</span><span class="p">,</span>
                          <span class="n">monitors</span><span class="o">=</span><span class="n">mons</span><span class="p">)</span>

<span class="n">sim</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>

<span class="c1"># Run</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting simulation...&quot;</span><span class="p">)</span>
<span class="n">tic</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">simulation_length</span> <span class="o">=</span> <span class="mi">6000</span>
<span class="n">ttavg</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">simulation_length</span><span class="o">=</span><span class="n">simulation_length</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Finished simulation.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;execute for &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">tic</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-1.98742113e+00 -1.87492138e+01  4.05295970e+00 -1.05214059e+00
 -4.95543740e-20 -1.98742113e-01]
Starting simulation...
2023-07-21 19:53:27,973 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
Finished simulation.
execute for 239.9383773803711
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="p">,</span> <span class="n">tavg</span> <span class="o">=</span> <span class="n">ttavg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tavg</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2000, 2, 162, 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tts</span> <span class="o">=</span> <span class="n">ttavg</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">tavg</span> <span class="o">=</span> <span class="n">ttavg</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="n">srcSig</span> <span class="o">=</span> <span class="n">tavg</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">start_idx</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">end_idx</span> <span class="o">=</span> <span class="mi">850</span>

<span class="n">srcSig_normal</span><span class="o">=</span><span class="n">srcSig</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">(</span><span class="n">srcSig</span><span class="p">)</span>
<span class="c1">#Plot raw time series</span>
<span class="n">figure</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">40</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tts</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">],</span><span class="n">srcSig</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[:</span><span class="mi">162</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Epileptors time series&quot;</span><span class="p">)</span>
<span class="n">roi</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">region_labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">roi</span><span class="p">)),</span><span class="n">roi</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">);</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="n">tts</span><span class="p">[</span><span class="n">start_idx</span><span class="p">],</span><span class="n">tts</span><span class="p">[</span><span class="n">end_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5e3a365eefbeb520033ab9318a6e4f92e0083b975be3bb32e476caa60b6bad18.png" src="../_images/5e3a365eefbeb520033ab9318a6e4f92e0083b975be3bb32e476caa60b6bad18.png" />
</div>
</div>
<p>Visualizing only the regions where the seizure is orginating and propagating</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region2plot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_EZ</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">idx_PZ</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()])</span>



<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">region2plot</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tts</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">],</span> <span class="n">srcSig</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">,</span> <span class="n">region2plot</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">region2plot</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">roi</span><span class="p">[</span><span class="n">region2plot</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7b6fc7431749d2e676728c54bcbfa70fcd7616239e73bf3c7a35b684e94ae2c6.png" src="../_images/7b6fc7431749d2e676728c54bcbfa70fcd7616239e73bf3c7a35b684e94ae2c6.png" />
</div>
</div>
<p><em><strong>3. Map timeseries onto SEEG using the gain matrix</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reading the reconstructed SEEG data</span>
<span class="n">seeg_xyz_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">data_path</span><span class="si">}</span><span class="s1">/seeg.xyz&#39;</span>
<span class="n">seeg_xyz</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">seeg_xyz_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fd</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
        <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">sxyz</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">xyz</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">sxyz</span><span class="p">]</span>
        <span class="n">seeg_xyz</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">name</span><span class="p">,</span> <span class="n">xyz</span><span class="p">))</span>

<span class="n">seeg_xyz_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span> <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">seeg_xyz</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reading the gain matrix file</span>
<span class="n">inv_gain_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">data_path</span><span class="si">}</span><span class="s1">/gain_inv-square.vep.txt&#39;</span>
<span class="n">invgain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">inv_gain_file</span><span class="p">)</span>

<span class="n">bip_gain</span><span class="p">,</span> <span class="n">bip_xyz</span><span class="p">,</span> <span class="n">bip_names</span> <span class="o">=</span> <span class="n">bipolarize_gain_minus</span><span class="p">(</span><span class="n">invgain</span><span class="p">,</span> <span class="n">seeg_xyz</span><span class="p">,</span> <span class="n">seeg_xyz_names</span><span class="p">)</span>
<span class="n">bip_gain_inv_prior</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span>  <span class="n">bipolarize_gain_minus</span><span class="p">(</span><span class="n">invgain</span><span class="p">,</span> <span class="n">seeg_xyz</span><span class="p">,</span> <span class="n">seeg_xyz_names</span><span class="p">,</span> <span class="n">is_minus</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bip_gain</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(154, 162)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gain matrix</span>
<span class="n">gain</span> <span class="o">=</span> <span class="n">bip_gain</span>
<span class="n">nsensor</span><span class="p">,</span> <span class="n">nchan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">gain</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gain</span><span class="p">,</span><span class="n">norm</span><span class="o">=</span><span class="n">plc</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">gain</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">gain</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">roi</span><span class="p">)],</span> <span class="n">roi</span><span class="p">,</span> <span class="n">rotation</span> <span class="o">=</span> <span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">bip_names</span><span class="p">)],</span> <span class="n">bip_names</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Region#&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Channel#&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; Gain Matrix (log scale)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f7f95465a46cde8363edb9154d789131cc354758cdbc3a195d1356be83a07ec1.png" src="../_images/f7f95465a46cde8363edb9154d789131cc354758cdbc3a195d1356be83a07ec1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mapping source level signals onto SEEG electrodes</span>
<span class="n">seeg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">gain</span><span class="p">,</span><span class="n">srcSig</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">show_ch</span> <span class="o">=</span> <span class="n">bip_names</span>
<span class="n">sfreq</span> <span class="o">=</span> <span class="mf">250.</span>
<span class="n">nch</span> <span class="o">=</span> <span class="p">[</span><span class="n">show_ch</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ichan</span><span class="p">)</span> <span class="k">for</span> <span class="n">ichan</span> <span class="ow">in</span> <span class="n">show_ch</span><span class="p">]</span>
<span class="n">nch_sourse</span> <span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">ind_ch</span><span class="p">,</span> <span class="n">ichan</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">show_ch</span><span class="p">):</span>
    <span class="n">isource</span> <span class="o">=</span> <span class="n">roi</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">bip_gain_inv_prior</span><span class="p">[</span><span class="n">ind_ch</span><span class="p">])]</span>
    <span class="n">nch_sourse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">isource</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">ichan</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span>
<span class="n">scaleplt</span><span class="o">=</span><span class="mf">0.07</span>
<span class="n">base_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">sfreq</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">ich</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nch</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tts</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">],</span> <span class="n">scaleplt</span><span class="o">*</span><span class="p">(</span><span class="n">seeg</span><span class="p">[</span><span class="n">ich</span><span class="p">,</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span><span class="o">-</span><span class="n">seeg</span><span class="p">[</span><span class="n">ich</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">+</span> <span class="n">ind</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Markers for seizure onset and offset</span>
<span class="n">TS_on</span> <span class="o">=</span> <span class="n">start_idx</span> <span class="o">+</span> <span class="mi">550</span>
<span class="n">TS_off</span> <span class="o">=</span> <span class="mi">2400</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">TS_on</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;DeepPink&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">TS_off</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;DeepPink&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">nch</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="n">tts</span><span class="p">[</span><span class="n">start_idx</span><span class="p">],</span><span class="n">tts</span><span class="p">[</span><span class="n">end_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ts_SEEG&#39;</span><span class="p">,</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">show_ch</span><span class="p">)),</span><span class="n">nch_sourse</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.97</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/74d763dd59789ccdebd956f739deefa5c2072693358643b762aa668307fb8cc1.png" src="../_images/74d763dd59789ccdebd956f739deefa5c2072693358643b762aa668307fb8cc1.png" />
</div>
</div>
<p><em><strong>4. Induce a seizure by stimulation</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here we set up the EZ node such that it is close to the critical working point, i.e. the seizure threshold</span>
<span class="n">x0ez</span><span class="o">=-</span><span class="mf">2.18</span>
<span class="n">x0pz</span><span class="o">=-</span><span class="mf">2.4</span>
<span class="n">x0num</span><span class="o">=-</span><span class="mf">2.9</span>

<span class="n">EZ</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Right-Hippocampus-anterior&#39;</span><span class="p">]</span>
<span class="n">idx_EZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">roi</span> <span class="o">==</span> <span class="n">EZ</span><span class="p">)</span>

<span class="n">epileptors</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Epileptor</span><span class="p">()</span>
<span class="n">epileptors</span><span class="o">.</span><span class="n">x0</span> <span class="o">=</span> <span class="n">x0num</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nb_regions</span><span class="p">)</span>
<span class="n">epileptors</span><span class="o">.</span><span class="n">x0</span><span class="p">[</span><span class="n">idx_EZ</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0ez</span>

<span class="c1"># Coupling</span>
<span class="n">coupl</span> <span class="o">=</span> <span class="n">coupling</span><span class="o">.</span><span class="n">Difference</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.2</span><span class="p">]))</span>

<span class="c1"># Integrators</span>
<span class="n">heunint</span> <span class="o">=</span> <span class="n">integrators</span><span class="o">.</span><span class="n">HeunDeterministic</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="c1"># Monitors</span>
<span class="n">mons</span> <span class="o">=</span> <span class="p">[</span><span class="n">monitors</span><span class="o">.</span><span class="n">TemporalAverage</span><span class="p">(</span><span class="n">period</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)]</span>

<span class="n">init_cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.98742113e+00</span> <span class="p">,</span> <span class="o">-</span><span class="mf">1.87492138e+01</span><span class="p">,</span> <span class="mf">4.0529597e+00</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.05214059e+00</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.95543740e-20</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.98742113e-01</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">init_cond</span><span class="p">)</span>
<span class="n">init_cond_reshaped</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">init_cond</span><span class="p">,</span> <span class="n">nb_regions</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">init_cond</span><span class="p">),</span> <span class="n">nb_regions</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Simulator</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">epileptors</span><span class="p">,</span>
                          <span class="n">initial_conditions</span><span class="o">=</span><span class="n">init_cond_reshaped</span><span class="p">,</span>
                          <span class="n">connectivity</span><span class="o">=</span><span class="n">con</span><span class="p">,</span>
                          <span class="n">coupling</span><span class="o">=</span><span class="n">coupl</span><span class="p">,</span>
                          <span class="n">integrator</span><span class="o">=</span><span class="n">heunint</span><span class="p">,</span>
                          <span class="n">monitors</span><span class="o">=</span><span class="n">mons</span><span class="p">)</span>

<span class="n">sim</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>

<span class="c1"># Run</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting simulation...&quot;</span><span class="p">)</span>
<span class="n">tic</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">simulation_length</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">ttavg</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">simulation_length</span><span class="o">=</span><span class="n">simulation_length</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Finished simulation.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;execute for &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">tic</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-1.98742113e+00 -1.87492138e+01  4.05295970e+00 -1.05214059e+00
 -4.95543740e-20 -1.98742113e-01]
Starting simulation...
2023-07-20 22:01:12,775 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
Finished simulation.
execute for 164.22741961479187
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tts</span> <span class="o">=</span> <span class="n">ttavg</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">tavg</span> <span class="o">=</span> <span class="n">ttavg</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="n">srcSig</span> <span class="o">=</span> <span class="n">tavg</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">start_idx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">end_idx</span> <span class="o">=</span> <span class="n">tavg</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">srcSig_normal</span><span class="o">=</span><span class="n">srcSig</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">(</span><span class="n">srcSig</span><span class="p">)</span>
<span class="c1">#Plot raw time series</span>
<span class="n">figure</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tts</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">],</span><span class="n">srcSig_normal</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[:</span><span class="mi">162</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Epileptors time series&quot;</span><span class="p">)</span>
<span class="n">roi</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">region_labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">roi</span><span class="p">)),</span><span class="n">roi</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># These should be set manually, since they depend on the model parameters</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="n">tts</span><span class="p">[</span><span class="n">start_idx</span><span class="p">],</span><span class="n">tts</span><span class="p">[</span><span class="n">end_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8a7c74d02573b1f44a5da387fbe714e38cf649222b9e99f87b7888a6bbfb5b67.png" src="../_images/8a7c74d02573b1f44a5da387fbe714e38cf649222b9e99f87b7888a6bbfb5b67.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adding the stimulus</span>
<span class="c1"># Stimulus parameters</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">onset</span> <span class="o">=</span> <span class="mi">3000</span> <span class="c1"># ms</span>
<span class="n">stim_length</span> <span class="o">=</span> <span class="n">onset</span> <span class="o">+</span> <span class="mi">1200</span> <span class="c1"># stimulation length (including onset) ms</span>
<span class="n">simulation_length</span> <span class="o">=</span> <span class="mi">7000</span> <span class="c1"># ms</span>
<span class="n">freq</span> <span class="o">=</span> <span class="mi">50</span><span class="o">/</span><span class="mi">1000</span> <span class="c1"># frequency converted to 1/ms</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">freq</span> <span class="c1"># pulse repetition period [ms]</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># pulse width [ms]</span>
<span class="n">I</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="c1"># intensity [mA]</span>

<span class="c1"># Temporal stimulation pattern</span>
<span class="k">class</span> <span class="nc">vector1D</span><span class="p">(</span><span class="n">equations</span><span class="o">.</span><span class="n">DiscreteEquation</span><span class="p">):</span>
    <span class="n">equation</span> <span class="o">=</span> <span class="n">equations</span><span class="o">.</span><span class="n">Final</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s2">&quot;emp&quot;</span><span class="p">)</span>
<span class="n">eqn_t</span> <span class="o">=</span> <span class="n">vector1D</span><span class="p">()</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="s1">&#39;tau&#39;</span><span class="p">:</span> <span class="n">tau</span><span class="p">,</span> <span class="s1">&#39;amp&#39;</span><span class="p">:</span> <span class="n">I</span><span class="p">,</span> <span class="s1">&#39;onset&#39;</span><span class="p">:</span> <span class="n">onset</span><span class="p">}</span>
<span class="n">pulse1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">equations</span><span class="o">.</span><span class="n">PulseTrain</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">)</span><span class="o">.</span><span class="n">get_series_data</span><span class="p">(</span><span class="n">max_range</span><span class="o">=</span><span class="n">stim_length</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<span class="n">pulse1_ts</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pulse1</span><span class="p">]</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="s1">&#39;tau&#39;</span><span class="p">:</span> <span class="n">tau</span><span class="p">,</span> <span class="s1">&#39;amp&#39;</span><span class="p">:</span> <span class="n">I</span><span class="p">,</span> <span class="s1">&#39;onset&#39;</span><span class="p">:</span> <span class="n">onset</span> <span class="o">+</span> <span class="n">tau</span><span class="p">}</span>
<span class="n">pulse2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">equations</span><span class="o">.</span><span class="n">PulseTrain</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">)</span><span class="o">.</span><span class="n">get_series_data</span><span class="p">(</span><span class="n">max_range</span><span class="o">=</span><span class="n">stim_length</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<span class="n">pulse2_ts</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pulse2</span><span class="p">]</span>
<span class="n">pulse_ts</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">pulse1_ts</span><span class="p">)</span> <span class="c1">#- np.asarray(pulse2_ts)</span>
<span class="n">stimulus_ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">pulse_ts</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">simulation_length</span> <span class="o">-</span> <span class="n">stim_length</span><span class="p">)</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)))))</span>
<span class="n">eqn_t</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;emp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">stimulus_ts</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Stimuli applied from the SEEG electrode&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stimulus_ts</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stimulus_ts</span><span class="p">[</span><span class="mi">60000</span><span class="p">:</span><span class="mi">70000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Stimuli applied from the SEEG electrode
</pre></div>
</div>
<img alt="../_images/d1e0177ccb13479180d5919a57d397f6322754ba02bf88a38a112374b6cbb124.png" src="../_images/d1e0177ccb13479180d5919a57d397f6322754ba02bf88a38a112374b6cbb124.png" />
<img alt="../_images/2e84d9c22704eff6b76c94d056068032ab931452c0c8d85e9cfed2fb48608c73.png" src="../_images/2e84d9c22704eff6b76c94d056068032ab931452c0c8d85e9cfed2fb48608c73.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Spatial stimulation pattern (via weights accross the network nodes)</span>
<span class="n">stim_weight</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">stim_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nb_regions</span><span class="p">))</span>
<span class="n">stim_weights</span><span class="p">[</span><span class="n">idx_EZ</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">stim_weight</span><span class="p">])</span>
<span class="n">stimulus</span> <span class="o">=</span> <span class="n">patterns</span><span class="o">.</span><span class="n">StimuliRegion</span><span class="p">(</span><span class="n">temporal</span><span class="o">=</span><span class="n">eqn_t</span><span class="p">,</span>
                                  <span class="n">connectivity</span><span class="o">=</span><span class="n">con</span><span class="p">,</span>
                                  <span class="n">weight</span><span class="o">=</span><span class="n">stim_weights</span><span class="p">)</span>
<span class="n">stimulus</span><span class="o">.</span><span class="n">configure_space</span><span class="p">()</span>
<span class="n">stimulus</span><span class="o">.</span><span class="n">configure_time</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">stimulus_ts</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_pattern</span><span class="p">(</span><span class="n">stimulus</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/daf53b2394bd5df638a15ec0da8498eb2678b216bdcca47478b0880be8f34805.png" src="../_images/daf53b2394bd5df638a15ec0da8498eb2678b216bdcca47478b0880be8f34805.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here we set up the nodes such that they&#39;re close to the critical working point# Initial conditions</span>
<span class="n">x0ez</span><span class="o">=-</span><span class="mf">2.18</span>
<span class="n">x0pz</span><span class="o">=-</span><span class="mf">2.2</span>
<span class="n">x0num</span><span class="o">=-</span><span class="mf">2.4</span>

<span class="n">EZ</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Right-Hippocampus-anterior&#39;</span><span class="p">]</span>
<span class="n">idx_EZ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">roi</span> <span class="o">==</span> <span class="n">EZ</span><span class="p">)</span>

<span class="n">epileptors</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Epileptor</span><span class="p">(</span><span class="n">slope</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">epileptors</span><span class="o">.</span><span class="n">x0</span> <span class="o">=</span> <span class="n">x0num</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nb_regions</span><span class="p">)</span>
<span class="n">epileptors</span><span class="o">.</span><span class="n">x0</span><span class="p">[</span><span class="n">idx_EZ</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0ez</span>

<span class="c1"># Initial conditions</span>
<span class="n">init_cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.98742113e+00</span> <span class="p">,</span> <span class="o">-</span><span class="mf">1.87492138e+01</span><span class="p">,</span> <span class="mf">4.0529597e+00</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.05214059e+00</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.95543740e-20</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.98742113e-01</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">init_cond</span><span class="p">)</span>
<span class="n">init_cond_reshaped</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">init_cond</span><span class="p">,</span> <span class="n">nb_regions</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">init_cond</span><span class="p">),</span> <span class="n">nb_regions</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Simulator</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">simulator</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">epileptors</span><span class="p">,</span>
                          <span class="n">stimulus</span><span class="o">=</span><span class="n">stimulus</span><span class="p">,</span>
                          <span class="n">initial_conditions</span><span class="o">=</span><span class="n">init_cond_reshaped</span><span class="p">,</span>
                          <span class="n">connectivity</span><span class="o">=</span><span class="n">con</span><span class="p">,</span>
                          <span class="n">coupling</span><span class="o">=</span><span class="n">coupl</span><span class="p">,</span>
                          <span class="n">integrator</span><span class="o">=</span><span class="n">heunint</span><span class="p">,</span>
                          <span class="n">monitors</span><span class="o">=</span><span class="n">mons</span><span class="p">)</span>

<span class="n">sim</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>

<span class="c1"># Run</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Starting simulation...&quot;</span><span class="p">)</span>
<span class="n">tic</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">ttavg</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">simulation_length</span><span class="o">=</span><span class="n">simulation_length</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Finished simulation.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;execute for &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">tic</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-1.98742113e+00 -1.87492138e+01  4.05295970e+00 -1.05214059e+00
 -4.95543740e-20 -1.98742113e-01]
Starting simulation...
2023-07-19 20:08:05,480 - WARNING - tvb.simulator.integrators - random_state supplied for non-stochastic integration
Finished simulation.
execute for 202.96317386627197
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tts</span> <span class="o">=</span> <span class="n">ttavg</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">tavg</span> <span class="o">=</span> <span class="n">ttavg</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="n">srcSig</span> <span class="o">=</span> <span class="n">tavg</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">start_idx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">end_idx</span> <span class="o">=</span> <span class="n">tavg</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">srcSig_normal</span><span class="o">=</span><span class="n">srcSig</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">ptp</span><span class="p">(</span><span class="n">srcSig</span><span class="p">)</span>
<span class="c1">#Plot raw time series</span>
<span class="n">figure</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tts</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">],</span> <span class="n">srcSig_normal</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[:</span><span class="mi">162</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Epileptors time series&quot;</span><span class="p">)</span>
<span class="n">roi</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">region_labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">roi</span><span class="p">)),</span><span class="n">roi</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># These should be set manually, since they depend on the model parameters</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="n">tts</span><span class="p">[</span><span class="n">start_idx</span><span class="p">],</span><span class="n">tts</span><span class="p">[</span><span class="n">end_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/45ca0d475a133443d7dc8c110386d4e3d917f65a7b2eba2f2bde8f0c5f1b25fc.png" src="../_images/45ca0d475a133443d7dc8c110386d4e3d917f65a7b2eba2f2bde8f0c5f1b25fc.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tts</span><span class="p">[:],</span> <span class="n">tavg</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">idx_EZ</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x2-x1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tts</span><span class="p">[:],</span> <span class="n">tavg</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">idx_EZ</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stimulus</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">stimulus</span><span class="o">.</span><span class="n">temporal_pattern</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="s1">&#39;C7&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Stimulus&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variables for </span><span class="si">{</span><span class="n">EZ</span><span class="si">}</span><span class="s2"> epileptor&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [ms]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/be045df466f46d8ae074b126b6735a5ad7fac3e8740c8b0c6c620872ca041181.png" src="../_images/be045df466f46d8ae074b126b6735a5ad7fac3e8740c8b0c6c620872ca041181.png" />
</div>
</div>
</div>
</div>
<div class="section" id="conclusions">
<h2>Conclusions<a class="headerlink" href="#conclusions" title="Permalink to this heading">#</a></h2>
<p>In conclusion, this final session of the Educational Course has shed light on the critical role of whole-brain modeling in clinical settings. Throughout the tutorial, we have witnessed the remarkable power of simulating brain dynamics, unveiling intricate mechanisms associated with pathologies that are challenging to measure in vivo. Moreover, we have explored how whole-brain modeling plays a pivotal role in the discovery of disease biomarkers, enabling early-stage diagnosis and classification.</p>
<p>The spotlight of our discussions was focused on two significant diseases: Alzheimer’s disease and Epilepsy. By delving into these conditions, we have gained valuable insights into the potential of whole-brain modeling to revolutionize the understanding and management of neurological disorders.</p>
<p>As we wrap up this session, we are filled with enthusiasm and optimism for the future of whole-brain modeling in advancing clinical research. The knowledge and techniques shared here today have the potential to transform the way we diagnose, treat, and understand neurological diseases. By harnessing the power of computational modeling, we stand on the brink of groundbreaking advancements that will ultimately improve the lives of countless individuals worldwide.</p>
<p>Let us carry forward the valuable insights gained from this course and continue our collaborative efforts in pushing the boundaries of neuroscience. Together, we can pave the way for innovative approaches to tackle complex brain disorders and contribute to a healthier and more informed society.</p>
<p>With gratitude for your active participation and dedication to the field, we look forward to witnessing the incredible impact each of you will make in your future endeavors.</p>
<p>Thank you, and may our collective journey in the realm of whole-brain modeling be filled with inspiration and breakthroughs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>

<span class="c1"># Replace the form_link with your Google Form link</span>
<span class="n">form_link</span> <span class="o">=</span> <span class="s2">&quot;https://forms.gle/tFQtt4eQsKj2iGuT7&quot;</span>

<span class="c1"># Create the hyperlink and open the form in a new tab with increased font size</span>
<span class="n">HTML</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&lt;a href=&quot;</span><span class="si">{</span><span class="n">form_link</span><span class="si">}</span><span class="s1">&quot; target=&quot;_blank&quot; style=&quot;font-size: 30px;&quot;&gt;Click here to access the survey&lt;/a&gt;&#39;</span><span class="p">)</span>


<span class="c1">#@title #Survey</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><a href="https://forms.gle/tFQtt4eQsKj2iGuT7" target="_blank" style="font-size: 30px;">Click here to access the survey</a></div></div>
</div>
<p>##References</p>
<blockquote>
<div><p>Jansen, B.H. and Rit, V.G. (1995) <strong>Electroencephalogram and visual evoked potential generation in a mathematical model of coupled cortical columns.</strong> <em>Biological cybernetics</em>, 73(4), pp.357-366.</p>
</div></blockquote>
<blockquote>
<div><p>Da Silva, F.L., Hoeks, A., Smits, H. and Zetterberg, L.H. (1974). <strong>Model of brain rhythmic activity.</strong> <em>Kybernetik</em>, 15(1), pp.27-37.</p>
</div></blockquote>
<blockquote>
<div><p>David, O. and Friston, K.J. (2003) <strong>A neural mass model for MEG/EEG: coupling and neuronal dynamics.</strong> <em>NeuroImage</em>, 20(3), pp.1743-1755.</p>
</div></blockquote>
<blockquote>
<div><p>Dollomaja B., Makhalova J., Wang H., Bartolomei F., Jirsa V., Bernard C.(2023). <strong>Personalized whole brain modeling of status epilepticus.</strong> <em>Epilepsy Behav</em>, 142:109175. doi: 10.1016/j.yebeh.2023.109175.</p>
</div></blockquote>
<blockquote>
<div><p>Stefanovski, L., Triebkorn, P., Spiegler, A., Diaz-Cortes, MA.,, Solodkin, A., Jirsa, V., McIntosh, RA., Ritter, P., and Alzheimer’s Disease Neuroimaging Initiative, F.M. (2019). <strong>Linking Molecular Pathways and Large-Scale Computational Modeling to Assess Candidate Disease Mechanisms and Pharmacodynamics in Alzheimer’s Disease.</strong> *Front Comput Neurosci
*, DOI: 10.3389/fncom.2019.00054.</p>
</div></blockquote>
<blockquote>
<div><p>Wang H.,  Woodman M., Triebkorn P., Lemarechal JD.,, Jha J., Dollomaja B., Vattikonda AN., Sip V., Villalon SM, Hashemi M., Guye M., Makhalova J., Bartolomei F., Jirsa V. (2023). <strong>Delineating epileptogenic networks using brain imaging data and personalized modeling in drug-resistant epilepsy.</strong> <em>Sci Transl Med</em>, 15(680):eabp8982. doi: 10.1126/scitranslmed.abp8982</p>
</div></blockquote>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./materials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="2_Systems_Cognitive.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">2) Applications 1: Systems/Cognitive <br></p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">3) Applications 2: Clinical</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#sessions-s-speakers"><strong>Sessions’s Speakers</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#contents">Contents</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#linking-mechanistic-multi-scale-brain-simulation-and-knowledge-technology-towards-a-holistic-understanding-of-alzheimers-disease"><strong>Linking mechanistic multi-scale brain simulation and knowledge technology towards a holistic understanding of Alzheimer’s Disease</strong></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#cause-and-effect-model-for-abeta-sigmoidal-transfer-function-stefanovski-et-al-2019">Cause-and-effect model for Abeta: sigmoidal transfer function (Stefanovski et al. 2019)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#load-individual-abeta-pet-suvrs">Load individual Abeta PET SUVRs</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-histogram-of-molecular-input-data">Visualize histogram of molecular input data</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#available-parameters-are">Available parameters are:</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#whole-brain-modeling-for-epilepsy-diagnosis"><strong>Whole brain modeling for epilepsy diagnosis</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-synthetic-data"><strong>Generate Synthetic Data</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">Conclusions</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By GriffLab
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>